[{"path":"/articles/deconfounding.html","id":"context","dir":"Articles","previous_headings":"","what":"Context","title":"Deconfounding","text":"want explore different types confounding impact PLMMs — questions mind include: PLMM perform well? perform poorly? PLMM compare PCA different data contexts? PLMM uses PCs fixed effects – sense, ‘hybrid’ approach – way approach deconfounding data complex structure?","code":""},{"path":"/articles/deconfounding.html","id":"starting-with-some-test-data","dir":"Articles","previous_headings":"","what":"Starting with some test data","title":"Deconfounding","text":"Let’s compare three lasso models: glmnet, plmm linear predictor (default), plmm BLUP option.","code":"library(glmnet) #> Loading required package: Matrix #> Loaded glmnet 4.1-8 gb <- function(n=100, p=256, s=4, gamma=6, beta=2, B=20) {   mu <- matrix(rnorm(B*p), B, p)   z <- rep(1:B, each=n/B)   X <- matrix(rnorm(n*p), n, p) + mu[z,] |>     ncvreg::std()   b <- rep(c(beta, 0), c(s, p-s))   g <- seq(-gamma, gamma, length=B)   y <- X %*% b + g[z]   Z <- model.matrix(~0+factor(z))   list(y=y, X=X, beta=b, Z=Z, gamma=g, mu=mu, id=z) } l <- gb() cvg <- cv.glmnet(l$X, l$y) cvp <- cv.plmm(l$X, l$y, penalty='lasso') cvp_blup <- cv.plmm(l$X, l$y, penalty='lasso',                     type = 'blup',                     returnBiasDetails = TRUE)  # look at K -- note that this data scenario has a 'finer' population structure library(corrplot) #> corrplot 0.92 loaded corrplot(relatedness_mat(l$X), is.corr = F, tl.pos = \"n\")"},{"path":"/articles/deconfounding.html","id":"mspe","dir":"Articles","previous_headings":"Starting with some test data","what":"MSPE","title":"Deconfounding","text":"mean squared prediction error glmnet plmm, adding blup option makes improvement:","code":"min(cvg$cvm) #> [1] 3.403547 min(cvp$cve) #> [1] 2.920374 min(cvp_blup$cve) #> [1] 3.46859"},{"path":"/articles/deconfounding.html","id":"mse","dir":"Articles","previous_headings":"Starting with some test data","what":"MSE","title":"Deconfounding","text":"mean squared error, see \\(\\hat \\beta\\) better plmm","code":"crossprod(l$beta - coef(cvg)[-1]) |> drop() #> [1] 2.667106 crossprod(l$beta - coef(cvp)[-1]) |> drop() #> [1] 1.998864 crossprod(l$beta - coef(cvp_blup)[-1]) |> drop() #> [1] 1.998864"},{"path":[]},{"path":"/articles/filebacking.html","id":"step-1-preprocess-the-data","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish","what":"Step 1: preprocess the data","title":"Analyze high-dimensional PLINK data with filebacking","text":"important step begin – GWAS data, tell plmmr combine information across three PLINK files (.bed, .bim, .fam files). , create files want temporary directory just sake example. Users can specify folder choice rds_dir, shown : ’ll see lot messages printed console … result creation 2 files (show folder PLINK data ): std_penncath_lite.rds std_penncath_lite.bk. can examine ’s std_penncath_lite.rds using snp_attach() function bigsnpr package:","code":"temp_dir <- paste0(tempdir(),\"/\") # using a temporary directory process_plink(data_dir = get_example_data(parent = TRUE), # reads data from inst/extdata               rds_dir = temp_dir,               prefix = \"penncath_lite\",               gz = TRUE,               outfile = \"process_penncath\",               overwrite = TRUE,               impute_method = \"mode\") pen <- readRDS(file.path(temp_dir, \"std_penncath_lite.rds\")) str(pen) # note: genotypes and std_X are *not* in memory #  # we can check to see that our data have been standardized  std_X <- pen$std_X[,] colMeans(std_X) |> summary() # columns have mean zero... apply(std_X, 2, var) |> summary() # ... & variance 1"},{"path":"/articles/filebacking.html","id":"what-if-my-data-arent-in-plink-format","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish > Step 1: preprocess the data","what":"What if my data aren’t in PLINK format?","title":"Analyze high-dimensional PLINK data with filebacking","text":"methodology plmmr motivated applications GWAS, certainly isn’t limited context. Suppose high dimemsional data set, colon2 data – like colon data ships biglasso package, ’ve inserted NA values just didactic purposes.","code":"process_delim(file = \"colon2.txt\",           data_dir = get_example_data(parent = TRUE),           rds_dir = temp_dir,           ind.col = 2:2002) # don't use the 1st column; it has IDs in it  colon2 <- readRDS(file = file.path(temp_dir, \"std_colon2.rds\")) str(colon2) # notice that the columns with NA values were dropped"},{"path":"/articles/filebacking.html","id":"step-2-fit-a-model","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish","what":"Step 2: fit a model","title":"Analyze high-dimensional PLINK data with filebacking","text":"Note: data coming process_plink(), y argument plmm() defaults using 6th column ‘.fam’ file phenotype/outcome (PLINK ). format similar data came process_delim – however, case colon2 data, need supply kinship matrix. data genomic, estimating genomic relatedness matrix doesn’t make sense. purposes, make ‘dummy’ K matrix. applications, want fit model using cross validation","code":"my_fb_data <- paste0(temp_dir, \"std_penncath_lite\") fb_fit <- plmm(X = my_fb_data,                returnX = FALSE,                 # this datset is small enough to fit in memory                # by setting returnX = FALSE, I force plmm() to run on the filebacked data                trace = TRUE) # pretend genomic data from 500 SNPs genomic_dat <- matrix(sample(0:2, 62*500, replace = TRUE), nrow = 62, ncol = 500) K <- relatedness_mat(genomic_dat)  colon2_fit <- plmm(X = file.path(temp_dir, \"std_colon2\"),                    y = rnorm(62),                    K = K,                    returnX = FALSE,                    trace = TRUE) cv_fb_fit <- cv.plmm(X = my_fb_data,                      type = 'blup',                      returnX = FALSE,                      nfolds = 3, # for sake of testing, I made this small.                       # In practice, 3 folds is usually not enough for robust                       # cross validation - hence, the default is nfolds = 10                      returnBiasDetails = TRUE,                      trace = TRUE)"},{"path":"/articles/filebacking.html","id":"step-3-plotsummarize-results","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish","what":"Step 3: Plot/summarize results","title":"Analyze high-dimensional PLINK data with filebacking","text":"summarize single model (CV), can look plot coefficient paths: can also examine number selected variables particular index \\(\\lambda\\): summarize plot CV fit, can look plot cross validation error: summarize visualize model chosen \\(\\lambda\\) parameter value, can :","code":"plot(fb_fit) summary(fb_fit, idx = 50) plot(cv_fb_fit) summary(cv_fb_fit)"},{"path":"/articles/filebacking.html","id":"comparing-candidate-models","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish","what":"Comparing candidate models","title":"Analyze high-dimensional PLINK data with filebacking","text":"default penalty plmmr minimax-concave penalty (MCP)1. Suppose want compare MCP-penalized model results lasso-penalized model. can fit lasso model shown:","code":"fb_lasso <- plmm(X = my_fb_data,                  penalty = \"lasso\",                  returnX = FALSE,                  trace = TRUE)  plot(fb_lasso) summary(fb_lasso, idx = 50)   # with CV  cv_fb_lasso <- cv.plmm(X = my_fb_data,                        penalty = \"lasso\",                      type = 'blup',                      nfolds = 3,                       returnX = FALSE,                      trace = TRUE)  plot(cv_fb_lasso)  summary(cv_fb_lasso)"},{"path":"/articles/filebacking.html","id":"to-add-predictors-that-are-not-genomic","dir":"Articles","previous_headings":"Analyzing filebacked data from start to finish","what":"To add predictors that are not genomic","title":"Analyze high-dimensional PLINK data with filebacking","text":"many biological applications, want include features/covariates/predictors addition genomic information, like clinical demographic information. Let’s suppose penncath data analysis, want include ‘sex’ ‘age’ unpenalized covariates. can supplying additional argument process_plink(): usually want kinds variables always model (.e., penalized). make sure ‘sex’ ‘age’ always included chosen model, let’s set penalty.factor 0 values corresponding predictors. can check additional covariates impact model fit:","code":"pen_clinic <- read.csv(paste0(get_example_data(parent = TRUE), \"/penncath_clinical.csv\")) extdata <- pen_clinic[,3:4] rownames(extdata) <- pen_clinic$FamID # This is important!   # create a new temporary directory temp_dir2 <- paste0(tempdir(), sample(LETTERS, 1))  process_plink(data_dir = get_example_data(parent = TRUE),               rds_dir = temp_dir2, # using a temporary directory               prefix = \"penncath_lite\",               id_var = \"FID\", # this is KEY!               outfile = \"process_penncath\",               impute_method = \"mode\",               add_predictor_ext = extdata)  # check this out:  pen2 <- readRDS(paste0(temp_dir2, \"/std_penncath_lite.rds\")) pen2$std_X_colnames |> head() # std_X includes our non-genomic covariates dat_plus_newvars <- paste0(temp_dir2, \"/std_penncath_lite\") fit_plus_newvars <- plmm(X = dat_plus_newvars,                penalty.factor = c(0, 0, rep(1, ncol(pen2$std_X) - 2)),                 K = list(U = fb_fit$U[,], s = fb_fit$s),                 returnX = FALSE,                trace = TRUE) plot(fit_plus_newvars)  summary(fb_fit, idx = 1)  summary(fit_plus_newvars, idx = 1) # at highest penalty value, sex and age are still in the model  # look at the estimated coefficients  fb_fit$beta_vals[1:10, 1:5] fit_plus_newvars$beta_vals[1:10, 1:5]"},{"path":"/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting started with plmm","text":"plmmr (stands Penalized Linear Mixed Models R) R package created purpose fitting penalized regression models high dimensional data, particularly observations correlated. kind data arises often context genetics (e.g. GWAS dealing population structure/family structure), motivation examples presented . time, package designed linear regression – , considering continuous (numeric) outcomes. many applications high dimensional data, objective statistical models identify signals - example, many GWAS interested identifying set variants show evidence association outcome. Practitioners situations often interested identifying biological pathways estimating odds ratios individual variants. applications, treating binary categorical outcomes numeric values possibility. future, like extend package handle logistic regression (handle dichotomous outcomes). Since focused penalized regression package, plmmr offers 3 choices penalty: minimax concave (MCP), smoothly clipped absolute deviation (SCAD), least absolute shrinkage selection operator (LASSO). 1 Much work package built concepts/techniques provided ncvreg package Patrick Breheny. filebacked computation relies bigsnpr package Florian Privé biglasso package Yaohui Zeng & Patrick Breheny. plmmr currently includes two example data sets: admix small data set (197 observations, 100 SNPs) describes individuals different ancestry groups. outcome admix simulated include population structure effects (.e. race/ethnicity impact SNP associations). data set available .rda object data/ folder. penncath_lite (data coronary artery disease PennCath study) mid-sized, high dimensional data set (1401 observations, 4217 SNPs) several health outcomes well age sex information. data set subset much larger data set (original data 800K SNPs). information data set, refer original publication. overview, provide demo main functions plmmr using admix data. Checkout ‘Working PLINK files’ vignette see demo processing penncath_lite data original PLINK file formats.","code":""},{"path":"/articles/getting-started.html","id":"basic-model-fitting","dir":"Articles","previous_headings":"","what":"Basic model fitting","title":"Getting started with plmm","text":"admix data already formatted elements \\(X\\) \\(y\\), can jump right call plmmr::plmm() (main function): returned beta_vals item matrix whose rows \\(\\hat\\beta\\) coefficients whose columns represent values penalization parameter \\(\\lambda\\). default, plmm fits 100 values \\(\\lambda\\) (see setup_lambda function details). Note values \\(\\lambda\\), SNP 8 \\(\\hat \\beta = 0\\). SNP 8 constant feature, feature (column) whose values vary among members population. can summarize fit nth \\(\\lambda\\) value: can also plot path fit see model coefficients vary \\(\\lambda\\): Plot path model fit Suppose also know ancestry groups person admix data self-identified. probably want include model unpenalized covariate (.e., want ‘ancestry’ always model). look:","code":"admix_fit <- plmm(X = admix$X, y = admix$y) summary(admix_fit, lambda = admix_fit$lambda[50]) #> MCP-penalized regression model with n=197, p=101 at lambda=0.01401 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  88  #> ------------------------------------------------- admix_fit$beta_vals[1:10, 97:100] |>    knitr::kable(digits = 3,                format = \"html\") # for n = 25  summary(admix_fit, lambda = admix_fit$lambda[25]) #> MCP-penalized regression model with n=197, p=101 at lambda=0.08018 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  43  #> ------------------------------------------------- plot(admix_fit) X_plus_ancestry <- cbind(admix$race, admix$X) colnames(X_plus_ancestry) <- c(\"ancestry\", colnames(admix$X)) admix_fit2 <- plmm(X = X_plus_ancestry, y = admix$y,                    penalty = \"lasso\",                    non_genomic = 1, # mark ancestry variable as non-genomic                     # make the penalty factor 0 to keep the corresponding covariate unpenalized                    penalty.factor = c(0, rep(1, ncol(admix$X))))  summary(admix_fit2, idx = 95) #> lasso-penalized regression model with n=197, p=102 at lambda=0.00076 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  97  #> ------------------------------------------------- plot(admix_fit2)"},{"path":"/articles/getting-started.html","id":"cross-validation","dir":"Articles","previous_headings":"","what":"Cross validation","title":"Getting started with plmm","text":"select \\(\\lambda\\) value, often use cross validation. example using cv.plmm select \\(\\lambda\\) minimizes cross-validation error: can also plot cross-validation error (CVE) versus \\(\\lambda\\) (log scale): Plot CVE","code":"admix_cv <- cv.plmm(X = X_plus_ancestry, y = admix$y,                     penalty = \"lasso\",                     non_genomic = 1, # mark ancestry variable as non-genomic                     penalty.factor = c(0, rep(1, ncol(admix$X)))) admix_cv_s <- summary(admix_cv, lambda = \"min\") print(admix_cv_s) #> lasso-penalized model with n=197 and p=100 #> At minimum cross-validation error (lambda=0.1848): #> ------------------------------------------------- #>   Nonzero coefficients: 3 #>   Cross-validation error (deviance): 1.32 #>   Scale estimate (sigma): 1.147 plot(admix_cv)"},{"path":"/articles/getting-started.html","id":"predicted-values","dir":"Articles","previous_headings":"","what":"Predicted values","title":"Getting started with plmm","text":"example predict() methods PLMMs: can compare predictions predictions get intercept-model using mean squared prediction error (MSPE) – lower better: see model better predictions null","code":"# make predictions for select lambda value(s) y_hat <- predict(object = admix_fit,                        newX = admix$X,                        type = \"blup\",                        X = admix$X,                        y = admix$y,                        lambda = admix_cv$lambda.min) # intercept-only (or 'null') model crossprod(admix$y - mean(admix$y))/length(admix$y) #>          [,1] #> [1,] 5.928528  # our model crossprod(admix$y - y_hat)/length(admix$y) #>          [,1] #> [1,] 1.109475"},{"path":"/articles/notation.html","id":"math-notation","dir":"Articles","previous_headings":"","what":"Math notation","title":"Notes on notation","text":"concepts need denote, order usage derivations. blocked sections corresponding steps model fitting process.","code":""},{"path":"/articles/notation.html","id":"statistical-model-the-overall-framework","dir":"Articles","previous_headings":"Math notation","what":"Statistical model (the overall framework)","title":"Notes on notation","text":"overall model can written \\[ \\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\mathbf{Z}\\boldsymbol{\\gamma} + \\boldsymbol{\\epsilon} \\] equivalently \\[ \\mathbf{y} = \\dot{\\mathbf{X}}\\dot{\\boldsymbol{\\beta}} + \\mathbf{u} + \\boldsymbol{\\epsilon} \\] : \\(\\mathbf{X}\\) \\(\\mathbf{y}\\) \\(n \\times p\\) design matrix data \\(n \\times 1\\) vector outcomes, respectively. , \\(n\\) number observations (e.g., number patients, number samples, etc.) \\(p\\) number features (e.g., number SNPs, number variables, number covariates, etc.). \\(\\dot{\\mathbf{X}}\\) column-standardized \\(\\mathbf{X}\\), \\(p\\) columns mean 0 standard deviation 1. Note: \\(\\dot{\\mathbf{X}}\\) excludes singular features (columns constants) original \\(\\mathbf{X}\\). \\(\\dot{\\boldsymbol{\\beta}}\\) represents coefficients standardized scale. \\(\\mathbf{Z}\\) \\(n \\times b\\) matrix indicators corresponding grouping structure, \\(\\boldsymbol{\\gamma}\\) vector values describing grouping associated \\(\\mathbf{y}\\). real data, values typically unknown. \\(\\boldsymbol{\\epsilon}\\) \\(n \\times 1\\) vector noise. define realized (empirical) relatedness matrix \\(\\mathbf{K} \\equiv \\frac{1}{p}\\dot{\\mathbf{X}}\\dot{\\mathbf{X}}^\\top\\) model assumes: \\(\\boldsymbol{\\epsilon} \\perp \\mathbf{u}\\) \\(\\boldsymbol{\\epsilon} \\sim N(0, \\sigma^2_{\\epsilon}\\mathbf{})\\) \\(\\mathbf{u} \\sim N(0, \\sigma^2_{s}\\mathbf{K})\\) assumptions, may write \\(\\mathbf{y} \\sim N(\\dot{\\mathbf{X}}\\dot{\\boldsymbol{\\beta}}, \\boldsymbol{\\Sigma})\\) Indices: \\(\\1,..., n\\) indexes observations \\(j \\1,..., p\\) indexes features \\(h \\1,..., b\\) indexes batches (e.g., different family groups, different data collection sites, etc.)","code":""},{"path":"/articles/notation.html","id":"decomposition-and-rotation-prep-and-first-part-of-fit","dir":"Articles","previous_headings":"Math notation","what":"Decomposition and rotation (prep and first part of fit)","title":"Notes on notation","text":"Beginning eigendecomposition, \\(\\mathbf{U}\\) \\(\\mathbf{d}\\) eigenvectors eigenvalues \\(\\mathbf{K}\\), one obtain \\(\\text{eigen}(\\mathbf{K)} \\equiv \\mathbf{U}\\mathbf{D}\\mathbf{U}^\\top\\). elements \\(\\mathbf{d}\\) diagonal values \\(\\mathbf{D}\\). Note, random effect \\(\\mathbf{u}\\) distinct columns matrix \\(\\mathbf{U}\\). \\(k\\) represents number nonzero eigenvalues represented \\(\\mathbf{U}\\) \\(\\mathbf{d}\\), \\(k \\leq \\text{min}(n,p)\\). \\(\\mathbf{S} \\equiv \\frac{1}{p}\\mathbf{D}^2\\) \\(k \\times k\\) diagonal matrix whose diagonal values \\(\\frac{d_k^2}{p}\\). , \\(\\mathbf{K} \\equiv \\frac{1}{p}\\dot{\\mathbf{X}}\\dot{\\mathbf{X}}^{\\top}\\) often referred literature realized relatedness matrix (RRM) genomic relatedness matrix (GRM). \\(\\mathbf{K}\\) dimension \\(n \\times n\\). \\(\\eta\\) ratio \\(\\frac{\\sigma^2_s}{\\sigma^2_e + \\sigma^2_s}\\). estimate \\(\\hat{\\eta}\\) null model (details come). \\(\\mathbf{\\Sigma}\\) variance outcome, \\(\\mathbb{V}({\\mathbf{y}}) = \\eta \\mathbf{K} + (1 - \\eta)\\mathbf{}_n\\). \\(\\mathbf{w}\\) vector weights defined \\((\\eta\\mathbf{\\mathbf{s}} + (1-\\eta))^{-1/2}\\). values \\(\\mathbf{w}\\) nonzero values diagonal matrix \\(\\mathbf{W} \\equiv (\\eta\\mathbf{S} + (1 - \\eta)\\mathbf{})^{-1/2}\\). matrix used rotating (preconditioning) data \\(\\mathbf{\\Sigma}^{-1/2} \\equiv \\mathbf{W}\\mathbf{U}^\\top\\). \\(\\tilde{\\dot{\\mathbf{X}}} \\equiv \\mathbf{W}\\mathbf{U}^\\top\\dot{\\mathbf{X}}\\) rotated data, data transformed scale. \\(\\tilde{\\mathbf{y}} \\equiv \\mathbf{\\Sigma}^{-1/2}\\mathbf{y}\\) outcome rotated scale. \\(\\ddot{\\tilde{\\mathbf{X}}}\\) standardized rotated data. Note: standardization involves scaling, centering. post-rotation standardization impacts estimated coefficients well; define \\({\\ddot{\\boldsymbol{\\beta}}}\\) estimated coefficients scale.","code":""},{"path":"/articles/notation.html","id":"model-fitting-with-penalization","dir":"Articles","previous_headings":"Math notation","what":"Model fitting with penalization","title":"Notes on notation","text":"fit \\(\\tilde{\\mathbf{y}} \\sim \\ddot{\\tilde{\\mathbf{X}}}\\) using penalized linear mixed model, obtain \\(\\hat{\\ddot{\\boldsymbol{\\beta}}}\\) estimated coefficients. penalty parameter values (e.g., values lasso tuning parameter) indexed \\(\\lambda_l \\1,..., t\\).","code":""},{"path":"/articles/notation.html","id":"rescaling-results-format","dir":"Articles","previous_headings":"Math notation","what":"Rescaling results (format)","title":"Notes on notation","text":"obtain estimated coefficients original scale, values estimated model must unscaled (‘untransformed’) twice: adjust post-rotation standardization, adjust pre-rotation standardization. process written \\(\\hat{\\ddot{\\boldsymbol{\\beta}}} \\rightarrow \\hat{\\dot{\\boldsymbol{\\beta}}} \\rightarrow \\hat{\\boldsymbol{\\beta}}\\).","code":""},{"path":"/articles/notation.html","id":"object-names-in-source-code","dir":"Articles","previous_headings":"","what":"Object names in source code","title":"Notes on notation","text":"code, denote objects way: \\(\\mathbf{X}\\) \\(\\mathbf{y}\\) X y \\(\\dot{\\mathbf{X}}\\) std_X \\(\\tilde{\\dot{\\mathbf{X}}}\\) rot_X \\(\\ddot{\\tilde{\\mathbf{X}}}\\) stdrot_X \\(\\dot{\\mathbf{X}}\\dot{\\boldsymbol{\\beta}}\\) Xb","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Anna C. Reisetter. Author. Patrick J. Breheny. Author, maintainer. Tabitha K. Peter. Author. Yujing Lu. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Reisetter , Breheny P (2021). “Penalized linear mixed models structured genetic data.” Genetic epidemiology, 45(5), 427–444. https://doi.org/10.1002/gepi.22384.","code":"@Article{,   author = {Anna C. Reisetter and Patrick Breheny},   title = {Penalized linear mixed models for structured genetic data},   journal = {Genetic epidemiology},   year = {2021},   volume = {45},   pages = {427--444},   number = {5},   url = {https://doi.org/10.1002/gepi.22384}, }"},{"path":"/index.html","id":"plmmr-","dir":"","previous_headings":"","what":"plmmr","title":"Nonconvex Penalized Linear Mixed Models For Correlated Data","text":"plmmr (penalized linear mixed models R) package contains functions fit penalized linear mixed models correct unobserved confounding effects. Documentation package progress.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Nonconvex Penalized Linear Mixed Models For Correlated Data","text":"install latest version package: description motivation functions package (along examples) refer second module GWAS data tutorial","code":"devtools::install_github(\"pbreheny/plmmr\")"},{"path":"/index.html","id":"note-on-branches","dir":"","previous_headings":"","what":"Note on branches","title":"Nonconvex Penalized Linear Mixed Models For Correlated Data","text":"branches repo organized following way: master main branch latest updates gh_pages keeping documentation plmmr estimate_eta archived branch worked alternative approach estimating η. ’re keeping around reference writing. sign_flip archived branch examined issues caused +/- signs flipped part truncated SVD.","code":""},{"path":"/reference/MCP.html","id":null,"dir":"Reference","previous_headings":"","what":"helper function to implement MCP penalty — MCP","title":"helper function to implement MCP penalty — MCP","text":"helper function implement MCP penalty","code":""},{"path":"/reference/MCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper function to implement MCP penalty — MCP","text":"","code":"MCP(z, l1, l2, gamma, v)"},{"path":"/reference/MCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper function to implement MCP penalty — MCP","text":"z vector representing solution active set feature l1 upper bound (beta) l2 lower bound (beta) gamma tuning parameter MCP penalty v 'xtx' term","code":""},{"path":"/reference/SCAD.html","id":null,"dir":"Reference","previous_headings":"","what":"helper function to implement SCAD penalty — SCAD","title":"helper function to implement SCAD penalty — SCAD","text":"helper function implement SCAD penalty","code":""},{"path":"/reference/SCAD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper function to implement SCAD penalty — SCAD","text":"","code":"SCAD(z, l1, l2, gamma, v)"},{"path":"/reference/SCAD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper function to implement SCAD penalty — SCAD","text":"z solution active set feature l1 upper bound l2 lower bound gamma tuning parameter SCAD penalty v 'xtx' term","code":""},{"path":"/reference/add_external_phenotype.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to align genotype and phenotype data — add_external_phenotype","title":"A function to align genotype and phenotype data — add_external_phenotype","text":"function align genotype phenotype data","code":""},{"path":"/reference/add_external_phenotype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to align genotype and phenotype data — add_external_phenotype","text":"","code":"add_external_phenotype(geno, geno_id = \"sample.ID\", pheno, pheno_id, pheno_col)"},{"path":"/reference/add_external_phenotype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to align genotype and phenotype data — add_external_phenotype","text":"geno object created name_and_count_bigsnp() geno_id character string indicating ID column name 'fam' element genotype data list. Defautls 'sample.ID', equivalent 'IID' PLINK. pheno data frame least two columns: ID column phenotype column pheno_id string specifying name ID column pheno pheno_col string specifying name phenotype column pheno. column used default y argument 'plmm()'.","code":""},{"path":"/reference/add_external_phenotype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to align genotype and phenotype data — add_external_phenotype","text":"","code":"Nothing is returned; instead, the results are written to an RDS file.               By default, the RDS file in `geno` is overwritten. You may change this behavior by specifying a new               filename to `rdsfile`"},{"path":"/reference/add_predictors_to_bigsnp.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to add predictors to a filebacked matrix of data — add_predictors_to_bigsnp","title":"A helper function to add predictors to a filebacked matrix of data — add_predictors_to_bigsnp","text":"helper function add predictors filebacked matrix data","code":""},{"path":"/reference/add_predictors_to_bigsnp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to add predictors to a filebacked matrix of data — add_predictors_to_bigsnp","text":"","code":"add_predictors_to_bigsnp(   obj,   add_predictor_fam,   add_predictor_ext,   id_var,   og_plink_ids,   quiet )"},{"path":"/reference/add_predictors_to_bigsnp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to add predictors to a filebacked matrix of data — add_predictors_to_bigsnp","text":"obj bigSNP object add_predictor_fam Optional: want include \"sex\" (5th column .fam file) analysis, specify 'sex' . add_predictor_ext Optional: add additional covariates/predictors/features external file (.e., PLINK file). id_var String specifying column PLINK .fam file unique sample identifiers. Options \"IID\" (default) \"FID\". og_plink_ids Character vector passed name_and_count_bigsnp() quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/add_predictors_to_bigsnp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to add predictors to a filebacked matrix of data — add_predictors_to_bigsnp","text":"list 2 components: 'obj' - bigSNP object added element representing matrix includes additional predictors first columns 'non_gen' - integer vector ranges 1 number added predictors. Example: 2 predictors added, non_gen = 1:2","code":""},{"path":"/reference/admix.html","id":null,"dir":"Reference","previous_headings":"","what":"Admix: Semi-simulated SNP data — admix","title":"Admix: Semi-simulated SNP data — admix","text":"dataset containing 100 SNPs, demographic variable representing race, simulated outcome","code":""},{"path":"/reference/admix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Admix: Semi-simulated SNP data — admix","text":"","code":"admix"},{"path":"/reference/admix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Admix: Semi-simulated SNP data — admix","text":"list 3 components X SNP matrix (197 observations 100 SNPs) y vector simulated (continuous) outcomes race vector racial group categorization: # 0 = African, 1 = African American, 2 = European, 3 = Japanese","code":""},{"path":"/reference/admix.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Admix: Semi-simulated SNP data — admix","text":"https://hastie.su.domains/CASI/","code":""},{"path":"/reference/align_famfile_ids.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to support process_plink() — align_famfile_ids","title":"A helper function to support process_plink() — align_famfile_ids","text":"helper function support process_plink()","code":""},{"path":"/reference/align_famfile_ids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to support process_plink() — align_famfile_ids","text":"","code":"align_famfile_ids(id_var, quiet, add_predictor, og_plink_ids)"},{"path":"/reference/align_famfile_ids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to support process_plink() — align_famfile_ids","text":"id_var String specifying variable PLINK file unique id: 'FID' 'IID' quiet Logical: message printed? add_predictor External data include design matrix. add_predictors... arg process_plink() og_plink_ids Character vector PLINK ids (FID IID) original data (.e., data subsetting handling missing phenotypes)","code":""},{"path":"/reference/align_famfile_ids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to support process_plink() — align_famfile_ids","text":"object type add_predictor","code":""},{"path":"/reference/align_ids.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to support process_delim() — align_ids","title":"A helper function to support process_delim() — align_ids","text":"helper function support process_delim()","code":""},{"path":"/reference/align_ids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to support process_delim() — align_ids","text":"","code":"align_ids(rownames_X, id_var, quiet, add_predictor)"},{"path":"/reference/align_ids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to support process_delim() — align_ids","text":"rownames_X character vector rownames IDs observations filebacked matrix data id_var character vector values rownames_X quiet Logical: message printed? add_predictor External data include design matrix. add_predictors... arg process_delim()","code":""},{"path":"/reference/align_ids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to support process_delim() — align_ids","text":"object type add_predictor","code":""},{"path":"/reference/big_std.html","id":null,"dir":"Reference","previous_headings":"","what":"big_std A function to standardize a matrix stored as an FBM object — big_std","title":"big_std A function to standardize a matrix stored as an FBM object — big_std","text":"big_std function standardize matrix stored FBM object","code":""},{"path":"/reference/big_std.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"big_std A function to standardize a matrix stored as an FBM object — big_std","text":"","code":"big_std(X, center = NULL, scale, ns = NULL, std_bk_extension = NULL)"},{"path":"/reference/big_std.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"big_std A function to standardize a matrix stored as an FBM object — big_std","text":"X file-backed design matrix center vector centering values scale vector scaling values ns vector indices marking Non-Singular columns X. Defaults NULL (meaning columns assumed nonsingular). std_bk_extension string specifying backingfile standardized copy X. Default uses temporary directory.","code":""},{"path":"/reference/big_std.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"big_std A function to standardize a matrix stored as an FBM object — big_std","text":"standardized matrix class FBM","code":""},{"path":"/reference/coef.cv.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Coef method for ","title":"Coef method for ","text":"Coef method \"cv.plmm\" class","code":""},{"path":"/reference/coef.cv.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coef method for ","text":"","code":"# S3 method for cv.plmm coef(object, lambda, which = object$min, ...)"},{"path":"/reference/coef.cv.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coef method for ","text":"object object class \"cv.plmm.\" lambda numeric vector lambda values. Vector lambda indices coefficients return. Defaults lambda index minimum CVE. ... Additional arguments (used).","code":""},{"path":"/reference/coef.cv.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coef method for ","text":"Returns named numeric vector. Values coefficients model specified value either lambda . Names values lambda.","code":""},{"path":"/reference/coef.cv.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coef method for ","text":"","code":"# \\donttest{ #' cv_fit <- cv.plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X)) head(coef.cv.plmm(cv_fit)) #> Error in coef.cv.plmm(cv_fit): could not find function \"coef.cv.plmm\" # }"},{"path":"/reference/coef.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Coef method for ","title":"Coef method for ","text":"Coef method \"plmm\" class","code":""},{"path":"/reference/coef.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coef method for ","text":"","code":"# S3 method for plmm coef(object, lambda, which = 1:length(object$lambda), drop = TRUE, ...)"},{"path":"/reference/coef.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coef method for ","text":"object object class \"plmm.\" lambda numeric vector lambda values. Vector lambda indices coefficients return. drop Logical. ... Additional arguments.","code":""},{"path":"/reference/coef.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coef method for ","text":"Either numeric matrix (model fit data stored memory) sparse matrix (model fit data stored filebacked). Rownames feature names, columns values lambda.","code":""},{"path":"/reference/coef.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coef method for ","text":"","code":"# \\donttest{ fit <- plmm(admix$X, admix$y) (coef.plmm(fit)[1:10, 1:5]) #> Error in coef.plmm(fit): could not find function \"coef.plmm\" # }"},{"path":"/reference/construct_variance.html","id":null,"dir":"Reference","previous_headings":"","what":"a function to create the estimated variance matrix from a PLMM fit — construct_variance","title":"a function to create the estimated variance matrix from a PLMM fit — construct_variance","text":"function create estimated variance matrix PLMM fit","code":""},{"path":"/reference/construct_variance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"a function to create the estimated variance matrix from a PLMM fit — construct_variance","text":"","code":"construct_variance(fit, K = NULL, eta = NULL)"},{"path":"/reference/construct_variance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"a function to create the estimated variance matrix from a PLMM fit — construct_variance","text":"fit object returned plmm() K optional matrix eta optional numeric value 0 1; fit supplied, option must specified.","code":""},{"path":"/reference/construct_variance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"a function to create the estimated variance matrix from a PLMM fit — construct_variance","text":"Sigma_hat, matrix representing estimated variance","code":""},{"path":"/reference/convexMin.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate index for which objective function ceases to be locally convex — convexMin","title":"Calculate index for which objective function ceases to be locally convex — convexMin","text":"Calculate index objective function ceases locally convex","code":""},{"path":"/reference/convexMin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate index for which objective function ceases to be locally convex — convexMin","text":"","code":"convexMin(b, X, penalty, gamma, l2, family = \"gaussian\", penalty.factor)"},{"path":"/reference/convexMin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate index for which objective function ceases to be locally convex — convexMin","text":"b Matrix coefficient values. X Design matrix. penalty penalty applied model. Either \"MCP\", \"SCAD\", \"lasso\". gamma tuning parameter MCP/SCAD penalty. Default 3 MCP 3.7 SCAD. l2 L2. family \"gaussian\" currently supported. penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage.","code":""},{"path":"/reference/convexMin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate index for which objective function ceases to be locally convex — convexMin","text":"numeric value indicating index objective function longer locally convex","code":""},{"path":"/reference/count_constant_features.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to count constant features — count_constant_features","title":"A helper function to count constant features — count_constant_features","text":"helper function count constant features","code":""},{"path":"/reference/count_constant_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to count constant features — count_constant_features","text":"","code":"count_constant_features(counts, outfile, quiet)"},{"path":"/reference/count_constant_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to count constant features — count_constant_features","text":"counts object returned bigstatsr::big_counts() outfile String specifying name log file quiet Logical: message printed console ?","code":""},{"path":"/reference/count_constant_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to count constant features — count_constant_features","text":"ns numeric vector indicies non-singular columns matrix associated counts","code":""},{"path":"/reference/cv.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validation for plmm — cv.plmm","title":"Cross-validation for plmm — cv.plmm","text":"Performs k-fold cross validation lasso-, MCP-, SCAD-penalized linear mixed models grid values regularization parameter lambda.","code":""},{"path":"/reference/cv.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validation for plmm — cv.plmm","text":"","code":"cv.plmm(   X,   y = NULL,   std_needed = TRUE,   col_names = NULL,   non_genomic = NULL,   K = NULL,   diag_K = NULL,   eta_star = NULL,   penalty = \"MCP\",   penalty.factor = NULL,   type = \"blup\",   gamma,   alpha = 1,   lambda.min,   nlambda = 100,   lambda,   eps = 1e-04,   max.iter = 10000,   convex = TRUE,   dfmax = NULL,   warn = TRUE,   init = NULL,   cluster,   nfolds = 10,   seed,   fold = NULL,   returnY = FALSE,   returnBiasDetails = FALSE,   trace = FALSE,   save_rds = NULL,   return_fit = TRUE,   ... )"},{"path":"/reference/cv.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validation for plmm — cv.plmm","text":"X Design matrix model fitting. May include clinical covariates non-SNP data. y Continuous outcome vector. Defaults NULL, assuming outcome 6th column .fam PLINK file data. Can also user-supplied numeric vector. std_needed Logical: supplied X need standardized? Defaults TRUE. data processed PLINK files, standardization happens process_plink(). data supplied matrix, standardization happens plmm(). know data already standardized, set std_needed = FALSE -- atypical case. Note: failing standardize data lead incorrect analyses. default, X standardized internally. data processed PLINK files, standardization happens process_plink(). data supplied matrix, standardization happens plmm(). know data already standardized, set std_needed = FALSE -- atypical case. Note: failing standardize data lead incorrect analyses. col_names Optional vector column names design matrix. Defaults NULL. non_genomic Optional vector specifying columns design matrix represent features genomic, features excluded empirical estimation genomic relatedness. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). cases, 'non_genomic' defaults NULL (meaning plmm() assume columns X represent genomic features). K Similarity matrix used rotate data. either (1) known matrix reflects covariance y, (2) estimate (Default \\(\\frac{1}{p}(XX^T)\\)), (3) list components 'd' 'u', returned choose_k(). diag_K Logical: K diagonal matrix? reflect observations unrelated, can treated unrelated. Defaults FALSE. Note: plmm() check see matrix diagonal. want use diagonal K matrix, must set diag_K = TRUE. eta_star Optional argument input specific eta term rather estimate data. K known covariance matrix full rank, 1. penalty penalty applied model. Either \"MCP\" (default), \"SCAD\", \"lasso\". penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage. type character argument indicating returned predict.plmm(). type == 'lp', predictions based linear predictor, X beta. type == 'blup', predictions based sum linear predictor estimated random effect (BLUP). Defaults 'blup', shown superior prediction method many applications. gamma tuning parameter MCP/SCAD penalty (see details). Default 3 MCP 3.7 SCAD. alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. lambda.min smallest value lambda, fraction lambda.max. Default .001 number observations larger number covariates .05 otherwise. nlambda Length sequence lambda. Default 100. lambda user-specified sequence lambda values. default, sequence values length nlambda computed, equally spaced log scale. eps Convergence threshold. algorithm iterates RMSD change linear predictors coefficient less eps. Default 1e-4. max.iter Maximum number iterations (total across entire path). Default 10000. convex Calculate index objective function ceases locally convex? Default TRUE. dfmax Upper bound number nonzero coefficients. Default upper bound. However, large data sets, computational burden may heavy models large number nonzero coefficients. warn Return warning messages failures converge model saturation? Default TRUE. init Initial values coefficients. Default 0 columns X. cluster cv.plmm() can run parallel across cluster using parallel package. cluster must set advance using parallel::makeCluster(). cluster must passed cv.plmm(). nfolds number cross-validation folds. Default 10. seed may set seed random number generator order obtain reproducible results. fold fold observation belongs . default, observations randomly assigned. returnY cv.plmm() return linear predictors cross-validation folds? Default FALSE; TRUE, return matrix element row , column j fitted value observation fold observation excluded fit, jth value lambda. returnBiasDetails Logical: cross-validation bias (numeric value) loss (n x p matrix) returned? Defaults FALSE. trace set TRUE, inform user progress announcing beginning CV fold. Default FALSE. save_rds Optional: filepath name specified (e.g., save_rds = \"~/dir/my_results.rds\"), model results saved provided location. Defaults NULL, save result. return_fit Optional: logical value indicating whether fitted model returned plmm object current (assumed interactive) session. Defaults TRUE. ... Additional arguments plmm_fit","code":""},{"path":"/reference/cv.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-validation for plmm — cv.plmm","text":"list 11 items: type: type prediction used ('lp' 'blup') cve: numeric vector cross validation error (CVE) value lambda cvse: numeric vector estimated standard error associated value cve fold: numeric n length vector integers indicating fold observation assigned lambda: numeric vector lambda values fit: overall fit object, including predictors; list returned plmm() min: index corresponding value lambda minimizes cve lambda.min: lambda value cve minmized min1se: index corresponding value lambda within standard error minimizes cve lambda1se: largest value lambda error within 1 standard error minimum. null.dev: numeric value representing deviance intercept-model. supplied lambda sequence, quantity may meaningful.","code":""},{"path":"/reference/cv.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-validation for plmm — cv.plmm","text":"","code":"cv_fit <- cv.plmm(X = admix$X, y = admix$y, seed = 321) # \\donttest{ cv_s <- summary.cv.plmm(cv_fit, lambda = \"1se\") #> Error in summary.cv.plmm(cv_fit, lambda = \"1se\"): could not find function \"summary.cv.plmm\" print(cv_s) #> Error in eval(expr, envir, enclos): object 'cv_s' not found plot(cv_fit)   # filebacked example (file path is specific to current machine) # since this dataset is < 100Mb, have to specify returnX = FALSE for  # `get_data()` to return an FBM my_fb_data <- paste0(get_example_data(parent = TRUE), \"/penncath_lite\")  cv_fb_fit <- cv.plmm(X = my_fb_data, type = 'blup', returnX = FALSE,  trace = TRUE, nfolds = 3) #> Warning: cannot open compressed file '/home/runner/work/_temp/Library/plmmr/extdata/penncath_lite.rds', probable reason 'No such file or directory' #> Error in gzfile(file, \"rb\"): cannot open the connection  plot(cv_fb_fit) #> Error in eval(expr, envir, enclos): object 'cv_fb_fit' not found summary(cv_fb_fit) #> Error in eval(expr, envir, enclos): object 'cv_fb_fit' not found # }"},{"path":"/reference/cvf.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validation internal function for cv.plmm — cvf","title":"Cross-validation internal function for cv.plmm — cvf","text":"Internal function cv.plmm calls plmm fold subset original data.","code":""},{"path":"/reference/cvf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validation internal function for cv.plmm — cvf","text":"","code":"cvf(i, fold, type, cv.args, estimated_V, ...)"},{"path":"/reference/cvf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validation internal function for cv.plmm — cvf","text":"Fold number excluded fit. fold n-length vector fold-assignments. type character argument indicating returned predict.plmm. type == 'lp' predictions based linear predictor, $X beta$. type == 'individual' predictions based linear predictor plus estimated random effect (BLUP). cv.args List additional arguments passed plmm. estimated_V Estimated variance-covariance matrix using observations computing BLUP; NULL type = \"lp\" cv.plmm. ... Optional arguments predict_within_cv","code":""},{"path":"/reference/delta.html","id":null,"dir":"Reference","previous_headings":"","what":"a helper function to calculate the 'distance' between 2 matrices — delta","title":"a helper function to calculate the 'distance' between 2 matrices — delta","text":"helper function calculate 'distance' 2 matrices","code":""},{"path":"/reference/delta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"a helper function to calculate the 'distance' between 2 matrices — delta","text":"","code":"delta(A, B, type = \"F\")"},{"path":"/reference/delta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"a helper function to calculate the 'distance' between 2 matrices — delta","text":"matrix compared B B second matrix (think approximation ) type String indicating type norm used. See Matrix::norm() details","code":""},{"path":"/reference/eigen_K.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to take the eigendecomposition of K Note: This is faster than taking SVD of X when p >> n — eigen_K","title":"A function to take the eigendecomposition of K Note: This is faster than taking SVD of X when p >> n — eigen_K","text":"function take eigendecomposition K Note: faster taking SVD X p >> n","code":""},{"path":"/reference/eigen_K.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to take the eigendecomposition of K Note: This is faster than taking SVD of X when p >> n — eigen_K","text":"","code":"eigen_K(std_X, p, fbm_flag, ...)"},{"path":"/reference/eigen_K.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to take the eigendecomposition of K Note: This is faster than taking SVD of X when p >> n — eigen_K","text":"std_X standardized design matrix, stored FBM. p number columns unstandardized design matrix. fbm_flag Logical: std_X FBM obejct? Passed plmm(). ... Optional additional arguments bigstatsr::big_tcrossprodSelf(), note, one additional argument ind.col, used exclude unpenalized additional, non-genomic covariates (like sex, age, etc.) included calculation kinship.","code":""},{"path":"/reference/eigen_K.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to take the eigendecomposition of K Note: This is faster than taking SVD of X when p >> n — eigen_K","text":"list eigenvectors eigenvalues K","code":""},{"path":"/reference/estimate_eta.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate eta (to be used in rotating the data) This function is called internally by plmm() — estimate_eta","title":"Estimate eta (to be used in rotating the data) This function is called internally by plmm() — estimate_eta","text":"Estimate eta (used rotating data) function called internally plmm()","code":""},{"path":"/reference/estimate_eta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate eta (to be used in rotating the data) This function is called internally by plmm() — estimate_eta","text":"","code":"estimate_eta(n, s, U, y, eta_star)"},{"path":"/reference/estimate_eta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate eta (to be used in rotating the data) This function is called internally by plmm() — estimate_eta","text":"n number observations s singular values K, realized relationship matrix U left-singular vectors standardized design matrix y Continuous outcome vector.","code":""},{"path":"/reference/fbm2bm.html","id":null,"dir":"Reference","previous_headings":"","what":"Functions to convert between FBM and big.matrix type objects — fbm2bm","title":"Functions to convert between FBM and big.matrix type objects — fbm2bm","text":"Functions convert FBM big.matrix type objects","code":""},{"path":"/reference/fbm2bm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Functions to convert between FBM and big.matrix type objects — fbm2bm","text":"","code":"fbm2bm(fbm, desc = FALSE)"},{"path":"/reference/fbm2bm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Functions to convert between FBM and big.matrix type objects — fbm2bm","text":"fbm FBM object; see bigstatsr::FBM() details desc Logical: descriptor file desired (opposed filebacked big matrix)? Defaults FALSE.","code":""},{"path":"/reference/fbm2bm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Functions to convert between FBM and big.matrix type objects — fbm2bm","text":"big.matrix - see bigmemory::filebacked.big.matrix() details","code":""},{"path":"/reference/fbm2bm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Functions to convert between FBM and big.matrix type objects — fbm2bm","text":"","code":"colon2 <- read.delim(get_example_data(\"colon2.txt\"), header = TRUE) class(colon2) #> [1] \"data.frame\" bigstatsr::as_FBM(colon2) -> colon2_fbm fbm2bm(colon2_fbm) -> colon2_bm class(colon2_bm) #> [1] \"big.matrix\" #> attr(,\"package\") #> [1] \"bigmemory\""},{"path":"/reference/get_bm_from_plink.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"function convert output process_plink() big.matrix (passed biglasso::biglasso())","code":""},{"path":"/reference/get_bm_from_plink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"","code":"get_bm_from_plink(path, standardize = TRUE)"},{"path":"/reference/get_bm_from_plink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"path file path RDS object containing processed data. add '.rds' extension path. standardize Logical: data returned column-standardized form? Defaults TRUE. Please change unless super confident ...","code":""},{"path":"/reference/get_bm_from_plink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"list elements: 'X': big.matrix object design matrix data. standardize = TRUE, data corresponding std_X returned. Otherwise, data corresponding subset_X returned 'map': data frame .bim file information 'fam': data frame .fam file information 'ns': vector indicating columns X contain nonsingular features (.e., features variance != 0. 'center': standardize = TRUE, vector values centering column X returned 'scale': standardize = TRUE, vector values scaling column X returned","code":""},{"path":"/reference/get_bm_from_plink.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"function wrapper combining get_data() fbm2bm()","code":""},{"path":"/reference/get_bm_from_plink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to convert the output of process_plink() into a big.matrix (such as could be passed to biglasso::biglasso()) — get_bm_from_plink","text":"","code":"# \\donttest{ process_plink(data_dir = get_example_data(parent = TRUE),   prefix = \"penncath_lite\",   gz = TRUE,   outfile = \"process_penncath\",   # overwrite = TRUE, # uncomment if needed    impute_method = \"mode\") #>  #> Logging to process_penncath.log #> Preprocessing penncath_lite data: #> Creating  penncath_lite .rds #>  #> Unzipping .gz files - this could take a second #> There are  1401  observations and  4367  genomic features in the specified data files, representing chromosomes  1  -  22 #> There are a total of  3514 SNPs with missing values #> Of these,  13  are missing in at least 50% of the samples #> Will prune out  468  samples/observations with missing phenotype data. #> Imputing the missing (genotype) values using  mode  method #> Error: Two levels of parallelism are used. See `?assert_cores`.      my_path <- paste0(get_example_data(parent = TRUE), \"/penncath_lite\")   bm_data <- get_bm_from_plink(my_path) #> Note: The design matrix is being returned as a file-backed matrix (FBM) -- see bigstatsr::FBM() for details. #> Reminder: the X that is returned here is column-standardized. #>          #> A copy of the original data is available via the 'genotypes' matrix in the .rds object #> Error in if (obj$id_var == \"IID\") {    row_names <- as.character(obj$fam$sample.ID[obj$complete_phen])}: argument is of length zero # }"},{"path":"/reference/get_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":"Read processed data function intended called either process_plink() process_delim() called .","code":""},{"path":"/reference/get_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":"","code":"get_data(path, returnX, trace = TRUE)"},{"path":"/reference/get_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":"path file path RDS object containing processed data. add '.rds' extension path. returnX Logical: design matrix returned numeric matrix stored memory. default, FALSE object sizes exceeds 100 Mb. trace Logical: trace messages shown? Default TRUE.","code":""},{"path":"/reference/get_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":"list components: std_X, column-standardized design matrix either (1) numeric matrix (2) filebacked matrix (FBM). See bigstatsr::FBM() bigsnpr::bigSnp-class documentation details. fam, data frame containing pedigree information (like .fam file PLINK) map, data frame containing feature information (like .bim file PLINK) ns: vector indicating columns X contain nonsingular features (.e., features variance != 0. center: vector values centering column X scale: vector values scaling column X","code":""},{"path":"/reference/get_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":".rds object 'std_X' element - used design matrix analysis. design matrix include intercept column (added later plmm_fit()). returned list, fam data sorted family individual, dplyr::arrange(family.ID, sample.ID). rows X sorted align order fam, rownames X sample ID.","code":""},{"path":"/reference/get_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read in processed data This function is intended to be called after either process_plink() or process_delim() has been called once. — get_data","text":"","code":"# \\donttest{ temp_dir <- paste0(tempdir(),\"/\") # using a temporary directory process_plink(data_dir = get_example_data(parent = TRUE), # reads data from inst/extdata               rds_dir = temp_dir,               prefix = \"penncath_lite\",               gz = TRUE,               outfile = \"process_penncath\",               overwrite = TRUE,               impute_method = \"mode\") #>  #> Logging to process_penncath.log #> Preprocessing penncath_lite data: #> Creating  penncath_lite .rds #>  #> Unzipping .gz files - this could take a second #> There are  1401  observations and  4367  genomic features in the specified data files, representing chromosomes  1  -  22 #> There are a total of  3514 SNPs with missing values #> Of these,  13  are missing in at least 50% of the samples #> Will prune out  468  samples/observations with missing phenotype data. #> Imputing the missing (genotype) values using  mode  method #> Error: Two levels of parallelism are used. See `?assert_cores`.                 pen <- get_data(file.path(temp_dir, \"std_penncath_lite.rds\"))              #> Warning: cannot open compressed file '/tmp/Rtmpq1dXaW//std_penncath_lite.rds.rds', probable reason 'No such file or directory' #> Error in gzfile(file, \"rb\"): cannot open the connection  str(pen) #> Error in eval(expr, envir, enclos): object 'pen' not found # }"},{"path":"/reference/get_example_data.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to help with accessing example PLINK files — get_example_data","title":"A function to help with accessing example PLINK files — get_example_data","text":"function help accessing example PLINK files","code":""},{"path":"/reference/get_example_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to help with accessing example PLINK files — get_example_data","text":"","code":"get_example_data(path, parent = FALSE)"},{"path":"/reference/get_example_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to help with accessing example PLINK files — get_example_data","text":"path Argument (string) specifying path (filename) external data file extdata/ parent path=TRUE user wants name parent directory file located, set parent=TRUE. Defaults FALSE.","code":""},{"path":"/reference/get_example_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to help with accessing example PLINK files — get_example_data","text":"path=NULL, character vector file names returned. path given, character string full file path","code":""},{"path":"/reference/handle_missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to handle missing genotype values from PLINK data — handle_missingness","title":"A helper function to handle missing genotype values from PLINK data — handle_missingness","text":"helper function handle missing genotype values PLINK data","code":""},{"path":"/reference/handle_missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to handle missing genotype values from PLINK data — handle_missingness","text":"","code":"handle_missingness(   obj,   X,   counts,   na_phenotype_vals,   handle_missing_phen,   outfile,   quiet )"},{"path":"/reference/handle_missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to handle missing genotype values from PLINK data — handle_missingness","text":"obj bigSNP object X matrix genotype data  returned name_and_count_bigsnp counts dataframe created bigstatsr::big_counts() returned name_and_count_bigsnp na_phenotype_vals vector numeric values used code NA values phenotype/outcome ('affection' column bigSNP object, last column .fam file). Defaults -9 (matching PLINK conventions). handle_missing_phen string indicating missing phenotypes handled: \"prune\" (default): observations missing phenotype removed \"asis\": leaves missing phenotypes NA (fine outcome supplied later separate file) \"median\": impute missing phenotypes using median (warning: overly simplistic many cases). \"mean\": impute missing phenotypes using mean (warning: overly simplistic many cases). outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/handle_missingness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to handle missing genotype values from PLINK data — handle_missingness","text":"list two components: na_idx: logical vector indicating columns missing values prop_na: proportion missingness columns tagged 'na_idx'","code":""},{"path":"/reference/impute_snp_data.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to impute SNP data — impute_snp_data","title":"A function to impute SNP data — impute_snp_data","text":"function impute SNP data","code":""},{"path":"/reference/impute_snp_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to impute SNP data — impute_snp_data","text":"","code":"impute_snp_data(   obj,   X,   impute,   impute_method,   outfile,   quiet,   seed = as.numeric(Sys.Date()),   ... )"},{"path":"/reference/impute_snp_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to impute SNP data — impute_snp_data","text":"obj bigSNP object (created read_plink_files()) X matrix genotype data  returned name_and_count_bigsnp impute Logical: data imputed? Default TRUE. impute_method 'impute' = TRUE, argument specify kind imputation desired. Options : mode (default): Imputes frequent call. See bigsnpr::snp_fastImputeSimple() details. random: Imputes sampling according allele frequencies. mean0: Imputes rounded mean. mean2: Imputes mean rounded 2 decimal places. xgboost: Imputes using algorithm based local XGBoost models. See bigsnpr::snp_fastImpute() details. Note: can take several minutes, even relatively small data set. @param seed Numeric value passed seed impute_method = 'xgboost'. Defaults .numeric(Sys.Date()) \\@param outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. quiet Logical: messages printed console? Defaults TRUE ... Optional: additional arguments bigsnpr::snp_fastImpute() (relevant impute_method = \"xgboost\")","code":""},{"path":"/reference/impute_snp_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to impute SNP data — impute_snp_data","text":"Nothing returned, obj$genotypes overwritten imputed version data","code":""},{"path":"/reference/index_std_X.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to index standardized data — index_std_X","title":"Helper function to index standardized data — index_std_X","text":"Helper function index standardized data","code":""},{"path":"/reference/index_std_X.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to index standardized data — index_std_X","text":"","code":"index_std_X(std_X, non_genomic)"},{"path":"/reference/index_std_X.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to index standardized data — index_std_X","text":"std_X standardized matrix data (may filebacked) non_genomic Integer vector columns std_X representing non-genomic data.","code":""},{"path":"/reference/index_std_X.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to index standardized data — index_std_X","text":"list indices","code":""},{"path":"/reference/lamNames.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate nicely formatted lambda vec — lamNames","title":"Generate nicely formatted lambda vec — lamNames","text":"Generate nicely formatted lambda vec","code":""},{"path":"/reference/lamNames.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate nicely formatted lambda vec — lamNames","text":"","code":"lamNames(l)"},{"path":"/reference/lamNames.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate nicely formatted lambda vec — lamNames","text":"l Vector lambda values.","code":""},{"path":"/reference/lamNames.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate nicely formatted lambda vec — lamNames","text":"character vector formatted lambda value names","code":""},{"path":"/reference/lasso.html","id":null,"dir":"Reference","previous_headings":"","what":"helper function to implement lasso penalty — lasso","title":"helper function to implement lasso penalty — lasso","text":"helper function implement lasso penalty","code":""},{"path":"/reference/lasso.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"helper function to implement lasso penalty — lasso","text":"","code":"lasso(z, l1, l2, v)"},{"path":"/reference/lasso.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"helper function to implement lasso penalty — lasso","text":"z solution active set feature l1 upper bound l2 lower bound v 'xtx' term","code":""},{"path":"/reference/log_lik.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate the negative log-likelihood of an intercept-only Gaussian plmm model — log_lik","title":"Evaluate the negative log-likelihood of an intercept-only Gaussian plmm model — log_lik","text":"function allows evaluate negative log-likelihood linear mixed model assumption null model order estimate variance parameter, eta.","code":""},{"path":"/reference/log_lik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate the negative log-likelihood of an intercept-only Gaussian plmm model — log_lik","text":"","code":"log_lik(eta, n, s, U, y, rot_y = NULL)"},{"path":"/reference/log_lik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate the negative log-likelihood of an intercept-only Gaussian plmm model — log_lik","text":"eta proportion variance outcome attributable causal SNP effects. words, signal--noise ratio. n number observations s singular values K, realized relationship matrix U left-singular vectors standardized design matrix y Continuous outcome vector. rot_y Optional: y already rotated, can supplied. option designed log_lik() call within gic(), fit object supplied.","code":""},{"path":"/reference/loss.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Loss method for ","title":"Loss method for ","text":"Loss method \"plmm\" class","code":""},{"path":"/reference/loss.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loss method for ","text":"","code":"loss.plmm(y, yhat)"},{"path":"/reference/loss.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loss method for ","text":"y Observed outcomes (response) vector yhat Predicted outcomes (response) vector","code":""},{"path":"/reference/loss.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loss method for ","text":"numeric vector squared-error loss values forthe given observed predicted outcomes","code":""},{"path":"/reference/loss.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loss method for ","text":"","code":"fit <- plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X)) yhat <- predict(object = fit, newX = admix$X, type = 'lp', lambda = 0.05) head(loss.plmm(yhat = yhat, y = admix$y)) #>            [,1] #> [1,] 1.13179494 #> [2,] 0.03014894 #> [3,] 0.62415094 #> [4,] 0.08134270 #> [5,] 1.13024154 #> [6,] 1.11534014"},{"path":"/reference/name_and_count_bigsnp.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to label and summarize the contents of a bigSNP — name_and_count_bigsnp","title":"A helper function to label and summarize the contents of a bigSNP — name_and_count_bigsnp","text":"helper function label summarize contents bigSNP","code":""},{"path":"/reference/name_and_count_bigsnp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to label and summarize the contents of a bigSNP — name_and_count_bigsnp","text":"","code":"name_and_count_bigsnp(obj, id_var, quiet)"},{"path":"/reference/name_and_count_bigsnp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to label and summarize the contents of a bigSNP — name_and_count_bigsnp","text":"obj bigSNP object, possibly subset add_external_phenotype() id_var String specifying column PLINK .fam file unique sample identifiers. Options \"IID\" (default) \"FID\". quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/name_and_count_bigsnp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to label and summarize the contents of a bigSNP — name_and_count_bigsnp","text":"list components: counts: column-wise summary minor allele counts 'genotypes' obj: modified bigSNP list additional components X: obj$genotypes FBM pos: obj$map$physical.pos vector","code":""},{"path":"/reference/pedigree.html","id":null,"dir":"Reference","previous_headings":"","what":"Pedigree: mock genotype data from a family-based design. — pedigree","title":"Pedigree: mock genotype data from a family-based design. — pedigree","text":"mock dataset containing genotypes, family relationships, continuous phenotype dataset inspired one T. Peter's collaborative projects involving analysis congenital disorders family-based data. outcome indicated severity phenotype, higher values -> severe.","code":""},{"path":"/reference/pedigree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pedigree: mock genotype data from a family-based design. — pedigree","text":"","code":"pedigree"},{"path":[]},{"path":"/reference/pedigree.html","id":"pedigree","dir":"Reference","previous_headings":"","what":"pedigree","title":"Pedigree: mock genotype data from a family-based design. — pedigree","text":"list 3 components: X: Design matrix representing 23 family members 5 genes K: Matrix representing family members' relationships expected proportions genetic overlap. Values 0.5 represent parent-child sibling relationships; see data-raw/pedigree.R details. Note: correlation matrix. Use cov2cor() similar function obtain correlations. clinical: data frame 23 observations 3 variables: sample.id integer indicating sample.id (IID PLINK .fam file) sex biological sex participant (just like PLINK, 2 = female & 1 = male) y numeric value corresponding phenotype severity","code":""},{"path":"/reference/plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a linear mixed model with non-convex regularization — plmm","title":"Fit a linear mixed model with non-convex regularization — plmm","text":"function allows fit linear mixed model via non-convex penalized maximum likelihood. NB: function simply wrapper plmm_prep -> plmm_fit -> plmm_format","code":""},{"path":"/reference/plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a linear mixed model with non-convex regularization — plmm","text":"","code":"plmm(   X,   y = NULL,   std_needed = TRUE,   col_names = NULL,   non_genomic = NULL,   K = NULL,   diag_K = NULL,   eta_star = NULL,   penalty = \"MCP\",   penalty.factor = NULL,   init = NULL,   gamma,   alpha = 1,   dfmax = NULL,   lambda.min,   nlambda = 100,   lambda,   eps = 1e-04,   max.iter = 10000,   convex = TRUE,   warn = TRUE,   trace = FALSE,   save_rds = NULL,   return_fit = TRUE,   ... )"},{"path":"/reference/plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a linear mixed model with non-convex regularization — plmm","text":"X Design matrix object string file path design matrix. string, string passed get_data(). Note: X may include clinical covariates non-SNP data, missing values allowed. y Continuous outcome vector. Defaults NULL, assuming outcome 6th column .fam PLINK file data. Can also user-supplied numeric vector. std_needed Logical: supplied X need standardized? Defaults TRUE. data processed PLINK files, standardization happens process_plink(). data supplied matrix, standardization happens plmm(). know data already standardized, set std_needed = FALSE -- atypical case. Note: failing standardize data lead incorrect analyses. col_names Optional vector column names design matrix. Defaults NULL. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). non_genomic Optional vector specifying columns design matrix represent features genomic, features excluded empirical estimation genomic relatedness. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). cases, 'non_genomic' defaults NULL (meaning plmm() assume columns X represent genomic features). K Similarity matrix used rotate data. either : (1) known matrix reflects covariance y, (2) estimate (Default \\(\\frac{1}{p}(XX^T)\\)), (3) list components 'd' 'U', returned previous plmm() model fit data. diag_K Logical: K diagonal matrix? reflect observations unrelated, can treated unrelated. Defaults FALSE. Note: plmm() check see matrix diagonal. want use diagonal K matrix, must set diag_K = TRUE. eta_star Optional argument input specific eta term rather estimate data. K known covariance matrix full rank, 1. penalty penalty applied model. Either \"MCP\" (default), \"SCAD\", \"lasso\". penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage. init Initial values coefficients. Default 0 columns X. gamma tuning parameter MCP/SCAD penalty (see details). Default 3 MCP 3.7 SCAD. alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. dfmax Upper bound number nonzero coefficients. Default upper bound. However, large data sets, computational burden may heavy models large number nonzero coefficients. lambda.min smallest value lambda, fraction lambda.max. Default .001 number observations larger number covariates .05 otherwise. nlambda Length sequence lambda. Default 100. lambda user-specified sequence lambda values. default, sequence values length nlambda computed, equally spaced log scale. eps Convergence threshold. algorithm iterates RMSD change linear predictors coefficient less eps. Default 1e-4. max.iter Maximum number iterations (total across entire path). Default 10000. convex Calculate index objective function ceases locally convex? Default TRUE. warn Return warning messages failures converge model saturation? Default TRUE. trace set TRUE, inform user progress announcing beginning step modeling process. Default FALSE. save_rds Optional: filepath name specified (e.g., save_rds = \"~/dir/my_results.rds\"), model results saved provided location. Defaults NULL, save result. return_fit Optional: logical value indicating whether fitted model returned plmm object current (assumed interactive) session. Defaults TRUE. ... Additional optional arguments plmm_checks()","code":""},{"path":"/reference/plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a linear mixed model with non-convex regularization — plmm","text":"list includes: beta_vals: matrix estimated coefficients original scale. Rows predictors, columns values lambda rotated_scale_beta_vals: matrix estimated coefficients ~rotated~ scale. scale model fit. lambda: numeric vector lasso tuning parameter values used model fitting. eta: number (double) 0 1 representing estimated proportion variance outcome attributable population/correlation structure. s: vectof eigenvalues relatedness matrix K; see relatedness_mat() details. U: matrix eigenvalues relatedness matrix K rot_y: vector outcome values rotated scale. scale model fit. linear.predictors: matrix resulting product stdrot_X estimated coefficients ~rotated~ scale. penalty: character string indicating penalty model fit (e.g., 'MCP') gamma: numeric value indicating tuning parameter used SCAD lasso penalties used. relevant lasso models. alpha: numeric value indicating elastic net tuning parameter. convex.min: NULL (option add future!) loss: vector numeric values loss value lambda (calculated ~rotated~ scale) penalty.factor: vector indicators corresponding predictor, 1 = predictor penalized. ns_idx: vector indicies predictors constant features (.e., variation). p: number features n: number observations (instances) iter: numeric vector number iterations needed model fitting value lambda converged: vector logical values indicating whether model fitting converged value lambda","code":""},{"path":"/reference/plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a linear mixed model with non-convex regularization — plmm","text":"","code":"# using admix data  fit_admix1 <- plmm(X = admix$X, y = admix$y, std_needed = TRUE) s1 <- summary(fit_admix1, idx = 50) print(s1) #> MCP-penalized regression model with n=197, p=101 at lambda=0.01401 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  88  #> ------------------------------------------------- plot(fit_admix1)   # an example with p > n: fit_admix2 <- plmm(X = admix$X[1:50, ], y = admix$y[1:50]) s2 <- summary(fit_admix2, idx = 99) print(s2) #> MCP-penalized regression model with n=50, p=101 at lambda=0.0402 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  30  #> ------------------------------------------------- plot(fit_admix2) # notice: the default penalty is MCP   # Note: for examples with large data that are too big to fit in memory,  # see the filebacking article"},{"path":"/reference/plmm_checks.html","id":null,"dir":"Reference","previous_headings":"","what":"plmm_checks — plmm_checks","title":"plmm_checks — plmm_checks","text":"plmm_checks","code":""},{"path":"/reference/plmm_checks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plmm_checks — plmm_checks","text":"","code":"plmm_checks(   X,   y = NULL,   std_needed = NULL,   col_names = NULL,   non_genomic = NULL,   K = NULL,   diag_K = NULL,   eta_star = NULL,   penalty = c(\"MCP\", \"SCAD\", \"lasso\"),   penalty.factor = NULL,   init = NULL,   gamma,   alpha = 1,   dfmax = NULL,   trace = FALSE,   ... )"},{"path":"/reference/plmm_checks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plmm_checks — plmm_checks","text":"X Design matrix object string file path design matrix. string, string passed get_data(). Note: X may include clinical covariates non-SNP data, missing values allowed. y Continuous outcome vector. Defaults NULL, assuming outcome 6th column .fam PLINK file data. Can also user-supplied numeric vector. std_needed Logical: supplied X need standardized? Defaults NULL, since default, X standardized internally. data processed PLINK files, standardization happens process_plink(). data supplied matrix, standardization happens plmm(). know data already standardized, leave std_needed = FALSE -- atypical case. Note: failing standardize data lead incorrect analyses. col_names Optional vector column names design matrix. Defaults NULL. non_genomic Optional vector specifying columns design matrix represent features genomic, features excluded empirical estimation genomic relatedness. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). cases, 'non_genomic' defaults NULL (meaning plmm() assume columns X represent genomic features). K Similarity matrix used rotate data. either (1) known matrix reflects covariance y, (2) estimate (Default \\(\\frac{1}{p}(XX^T)\\)), (3) list components 'd' 'u', returned choose_k(). diag_K Logical: K diagonal matrix? reflect observations unrelated, can treated unrelated. Defaults FALSE. Note: plmm() check see matrix diagonal. want use diagonal K matrix, must set diag_K = TRUE. eta_star Optional argument input specific eta term rather estimate data. K known covariance matrix full rank, 1. penalty penalty applied model. Either \"MCP\" (default), \"SCAD\", \"lasso\". penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage. init Initial values coefficients. Default 0 columns X. gamma tuning parameter MCP/SCAD penalty (see details). Default 3 MCP 3.7 SCAD. alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. dfmax Upper bound number nonzero coefficients. Default upper bound. However, large data sets, computational burden may heavy models large number nonzero coefficients. trace set TRUE, inform user progress announcing beginning step modeling process. Default FALSE. ... Additional arguments get_data()","code":""},{"path":"/reference/plmm_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"PLMM fit: a function that fits a PLMM using the values returned by plmm_prep() — plmm_fit","title":"PLMM fit: a function that fits a PLMM using the values returned by plmm_prep() — plmm_fit","text":"PLMM fit: function fits PLMM using values returned plmm_prep()","code":""},{"path":"/reference/plmm_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLMM fit: a function that fits a PLMM using the values returned by plmm_prep() — plmm_fit","text":"","code":"plmm_fit(   prep,   std_X_details,   eta_star,   penalty.factor,   fbm_flag,   penalty = \"MCP\",   gamma,   alpha = 1,   lambda.min,   nlambda = 100,   lambda,   eps = 1e-04,   max.iter = 10000,   convex = TRUE,   dfmax = prep$p + 1,   init = NULL,   warn = TRUE,   returnX = TRUE,   ... )"},{"path":"/reference/plmm_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLMM fit: a function that fits a PLMM using the values returned by plmm_prep() — plmm_fit","text":"prep list returned plmm_prep std_X_details list components 'center' (values used center X), 'scale' (values used scale X), 'ns' (indices nonsignular columns X) eta_star ratio variances (passed plmm()) penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage. fbm_flag Logical: std_X FBM object? Passed plmm(). penalty penalty applied model. Either \"MCP\" (default), \"SCAD\", \"lasso\". gamma tuning parameter MCP/SCAD penalty (see details). Default 3 MCP 3.7 SCAD. alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. lambda.min smallest value lambda, fraction lambda.max. Default .001 number observations larger number covariates .05 otherwise. nlambda Length sequence lambda. Default 100. lambda user-specified sequence lambda values. default, sequence values length nlambda computed, equally spaced log scale. eps Convergence threshold. algorithm iterates RMSD change linear predictors coefficient less eps. Default 1e-4. max.iter Maximum number iterations (total across entire path). Default 10000. convex convex Calculate index objective function ceases locally convex? Default TRUE. dfmax (future idea; yet incorporated) Upper bound number nonzero coefficients. Default upper bound. However, large data sets, computational burden may heavy models large number nonzero coefficients. init Initial values coefficients. Default 0 columns X. warn Return warning messages failures converge model saturation? Default TRUE. returnX Return standardized design matrix along fit? default, option turned X 100 MB, turned larger matrices preserve memory. ... Additional arguments can passed biglasso::biglasso_simple_path()","code":""},{"path":"/reference/plmm_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLMM fit: a function that fits a PLMM using the values returned by plmm_prep() — plmm_fit","text":"list components: n: # rows X p: # columns X (including constant features) y: outcome original scale std_X_details: list 'center' 'scale' vectors, plmm_prep() s: eigenvalues K U: eigenvectors K rot_X: X rotated (.e., transformed) scale. Note dimensions rot_X likely different X. rot_y: y rotated scale stdrot_X: X rotated scale re-standardized. lambda: vector tuning parameter values b: coefficients estimated scale stdrot_X untransformed_b1: coefficients estimated scale std_X linear.predictors: product stdrot_X b (linear predictors transformed restandardized scale) eta: number (double) 0 1 representing estimated proportion variance outcome attributable population/correlation structure. iter: numeric vector number iterations needed model fitting value lambda converged: vector logical values indicating whether model fitting converged value lambda loss: vector numeric values loss value lambda (calculated ~rotated~ scale) penalty: character string indicating penalty model fit (e.g., 'MCP') penalty.factor: vector indicators corresponding predictor, 1 = predictor penalized. gamma: numeric value indicating tuning parameter used SCAD lasso penalties used. relevant lasso models. alpha: numeric value indicating elastic net tuning parameter. ns: indices nonsingular values X snp_names: formatted column names design matrix nlambda: number lambda values used model fitting eps: tolerance ('epsilon') used model fitting max.iter: max. number iterations per model fit warn: logical - warnings given model fit converge? init: initial values model fitting trace: logical - messages printed console models fit?","code":""},{"path":"/reference/plmm_format.html","id":null,"dir":"Reference","previous_headings":"","what":"PLMM format: a function to format the output of a model constructed with plmm_fit — plmm_format","title":"PLMM format: a function to format the output of a model constructed with plmm_fit — plmm_format","text":"PLMM format: function format output model constructed plmm_fit","code":""},{"path":"/reference/plmm_format.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLMM format: a function to format the output of a model constructed with plmm_fit — plmm_format","text":"","code":"plmm_format(fit, std_X_details, fbm_flag, snp_names = NULL, non_genomic = NULL)"},{"path":"/reference/plmm_format.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLMM format: a function to format the output of a model constructed with plmm_fit — plmm_format","text":"fit list parameters describing output model constructed plmm_fit std_X_details list 3 items: 'center': centering values columns X 'scale': scaling values non-singular columns X 'ns': indicies nonsingular columns std_X fbm_flag Logical: corresponding design matrix filebacked? Passed plmm(). snp_names vector names features, passed internally names included data X passed plmm() non_genomic Optional vector specifying columns design matrix represent features genomic, features excluded empirical estimation genomic relatedness. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). cases, 'non_genomic' defaults NULL (meaning plmm() assume columns X represent genomic features).","code":""},{"path":"/reference/plmm_format.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLMM format: a function to format the output of a model constructed with plmm_fit — plmm_format","text":"list components: beta_vals: matrix estimated coefficients original scale. Rows predictors, columns values lambda rotated_scale_beta_vals: matrix estimated coefficients ~rotated~ scale. scale model fit. lambda: numeric vector lasso tuning parameter values used model fitting. eta: number (double) 0 1 representing estimated proportion variance outcome attributable population/correlation structure. s: vectof eigenvalues relatedness matrix K; see relatedness_mat() details. U: matrix eigenvalues relatedness matrix K rot_y: vector outcome values rotated scale. scale model fit. linear.predictors: matrix resulting product stdrot_X estimated coefficients ~rotated~ scale. penalty: character string indicating penalty model fit (e.g., 'MCP') gamma: numeric value indicating tuning parameter used SCAD lasso penalties used. relevant lasso models. alpha: numeric value indicating elastic net tuning parameter. convex.min: NULL (option add future!) loss: vector numeric values loss value lambda (calculated ~rotated~ scale) penalty.factor: vector indicators corresponding predictor, 1 = predictor penalized. ns_idx: vector indicies predictors constant features (.e., variation). p: number features n: number observations (instances) iter: numeric vector number iterations needed model fitting value lambda converged: vector logical values indicating whether model fitting converged value lambda","code":""},{"path":"/reference/plmm_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"PLMM prep: a function to run checks, SVD, and rotation prior to fitting a PLMM model This is an internal function for cv.plmm — plmm_prep","title":"PLMM prep: a function to run checks, SVD, and rotation prior to fitting a PLMM model This is an internal function for cv.plmm — plmm_prep","text":"PLMM prep: function run checks, SVD, rotation prior fitting PLMM model internal function cv.plmm","code":""},{"path":"/reference/plmm_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PLMM prep: a function to run checks, SVD, and rotation prior to fitting a PLMM model This is an internal function for cv.plmm — plmm_prep","text":"","code":"plmm_prep(   std_X,   std_X_n,   std_X_p,   genomic = 1:std_X_p,   n,   p,   y,   k = NULL,   K = NULL,   diag_K = NULL,   eta_star = NULL,   fbm_flag,   penalty.factor = rep(1, ncol(std_X)),   trace = NULL,   ... )"},{"path":"/reference/plmm_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PLMM prep: a function to run checks, SVD, and rotation prior to fitting a PLMM model This is an internal function for cv.plmm — plmm_prep","text":"std_X Column standardized design matrix. May include clinical covariates non-SNP data. std_X_n number observations std_X (integer) std_X_p number features std_X (integer) genomic numeric vector indicies indicating columns standardized X genomic covariates. Defaults columns. n number instances original design matrix X. altered standardization. p number features original design matrix X, including constant features y Continuous outcome vector. k integer specifying number singular values used approximation rotated design matrix. argument passed RSpectra::svds(). Defaults min(n, p) - 1, n p dimensions standardized design matrix. K Similarity matrix used rotate data. either known matrix reflects covariance y, estimate (Default \\(\\frac{1}{p}(XX^T)\\), X standardized). can also list, components d u (returned choose_k) diag_K Logical: K diagonal matrix? reflect observations unrelated, can treated unrelated. Passed plmm(). eta_star Optional argument input specific eta term rather estimate data. K known covariance matrix full rank, 1. fbm_flag Logical: std_X FBM type object? set internally plmm(). trace set TRUE, inform user progress announcing beginning step modeling process. Default FALSE. ... used yet","code":""},{"path":"/reference/plmm_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PLMM prep: a function to run checks, SVD, and rotation prior to fitting a PLMM model This is an internal function for cv.plmm — plmm_prep","text":"List components: n: number rows original design matrix p: number columns original design matrix y: vector outcomes std_X: standardized design matrix std_X_details: list 2 vectors: 'center' (values used center X) 'scale' (values used scale X) s: vector eigenvalues K U: eigenvectors K (left singular values X). ns: indices nonsingular values X penalty.factor: penalty factors penalized non-singular values snp_names: formatted column names design matrix","code":""},{"path":"/reference/plmmr-package.html","id":null,"dir":"Reference","previous_headings":"","what":"plmmr: Nonconvex Penalized Linear Mixed Models For Correlated Data — plmmr-package","title":"plmmr: Nonconvex Penalized Linear Mixed Models For Correlated Data — plmmr-package","text":"Fits penalized linear mixed models correct unobserved confounding factors. 'plmmr' infers corrects presence unobserved confounding effects population stratification environmental heterogeneity. fits linear model via penalized maximum likelihood. Originally designed multivariate analysis single nucleotide polymorphisms (SNPs) measured genome-wide association study (GWAS), 'plmmr' eliminates need subpopulation-specific analyses post-analysis p-value adjustments. Functions appropriate processing 'PLINK' files also supplied. examples, see package homepage. https://pbreheny.github.io/plmmr/.","code":""},{"path":"/reference/plmmr-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"plmmr: Nonconvex Penalized Linear Mixed Models For Correlated Data — plmmr-package","text":"Maintainer: Patrick J. Breheny patrick-breheny@uiowa.edu (ORCID) Authors: Anna C. Reisetter anna-reisetter@uiowa.edu (ORCID) Tabitha K. Peter tabitha-peter@uiowa.edu (ORCID) Yujing Lu","code":""},{"path":"/reference/plot.cv.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for cv.plmm class — plot.cv.plmm","title":"Plot method for cv.plmm class — plot.cv.plmm","text":"Plot method cv.plmm class","code":""},{"path":"/reference/plot.cv.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for cv.plmm class — plot.cv.plmm","text":"","code":"# S3 method for cv.plmm plot(   x,   log.l = TRUE,   type = c(\"cve\", \"rsq\", \"scale\", \"snr\", \"all\"),   selected = TRUE,   vertical.line = TRUE,   col = \"red\",   ... )"},{"path":"/reference/plot.cv.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for cv.plmm class — plot.cv.plmm","text":"x object class cv.plmm log.l Logical indicate plot returned natural log scale. Defaults log.l = FALSE. type Type plot return. Defaults \"cve.\" selected Logical indicate variables plotted. Defaults TRUE. vertical.line Logical indicate whether vertical line plotted minimum/maximum value. Defaults TRUE. col Color vertical line, plotted. Defaults \"red.\" ... Additional arguments.","code":""},{"path":"/reference/plot.cv.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for cv.plmm class — plot.cv.plmm","text":"Nothing returned; instead, plot drawn representing relationship tuning parameter 'lambda' value (x-axis) cross validation error (y-axis).","code":""},{"path":"/reference/plot.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for plmm class — plot.plmm","title":"Plot method for plmm class — plot.plmm","text":"Plot method plmm class","code":""},{"path":"/reference/plot.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for plmm class — plot.plmm","text":"","code":"# S3 method for plmm plot(x, alpha = 1, log.l = FALSE, shade = TRUE, col, ...)"},{"path":"/reference/plot.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for plmm class — plot.plmm","text":"x object class plmm alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. log.l Logical indicate plot returned natural log scale. Defaults log.l = FALSE. shade Logical indicate whether local nonconvex region shaded. Defaults TRUE. col Vector colors coefficient lines. ... Additional arguments.","code":""},{"path":"/reference/plot.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for plmm class — plot.plmm","text":"Nothing returned; instead, plot coefficient paths drawn value lambda (one 'path' value lambda).","code":""},{"path":"/reference/plot.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot method for plmm class — plot.plmm","text":"","code":"fit <- plmm(admix$X[,1:10], admix$y, nlambda = 10) # for the sake of illustration, I consider only 10 SNPs in the plot  plot(fit)   plot(fit, log.l = TRUE)"},{"path":"/reference/predict.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method for plmm class — predict.plmm","title":"Predict method for plmm class — predict.plmm","text":"Predict method plmm class","code":""},{"path":"/reference/predict.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method for plmm class — predict.plmm","text":"","code":"# S3 method for plmm predict(   object,   newX,   type = c(\"lp\", \"coefficients\", \"vars\", \"nvars\", \"blup\"),   lambda,   idx = 1:length(object$lambda),   X,   y,   K = NULL,   ... )"},{"path":"/reference/predict.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method for plmm class — predict.plmm","text":"object object class plmm. newX Design matrix used computing predicted values requested. can either FBM object matrix object. supply FBM object , function assumes matrix done. need standardization, see big_std() process_plink(). Columns must named! type character argument indicating type prediction returned. Options \"lp,\" \"coefficients,\" \"vars,\" \"nvars,\" \"blup.\" See details. lambda numeric vector regularization parameter lambda values predictions requested. idx Vector indices penalty parameter lambda predictions required. default, indices returned. X Original design matrix (including intercept column) object. Required type == 'blup' object large returned plmm object. , columns must named! y Original continuous outcome vector object. Required type == 'blup'. K optional list matrix returned choose_K(). ... Additional optional arguments","code":""},{"path":"/reference/predict.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict method for plmm class — predict.plmm","text":"Depends type - see Details","code":""},{"path":"/reference/predict.plmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method for plmm class — predict.plmm","text":"Define beta-hat coefficients estimated value lambda minimizes cross-validation error (CVE). options type follows: 'response' (default): uses product newX beta-hat predict new values outcome. incorporate correlation structure data. stats folks , simply linear predictor. 'blup' (acronym Best Linear Unbiased Predictor): adds 'response' value represents esetimated random effect. addition way incorporating estimated correlation structure data prediction outcome. 'coefficients': returns estimated beta-hat 'vars': returns indicies variables (e.g., SNPs) nonzero coefficients value lambda. EXCLUDES intercept. 'nvars': returns number variables (e.g., SNPs) nonzero coefficients value lambda. EXCLUDES intercept.","code":""},{"path":"/reference/predict.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict method for plmm class — predict.plmm","text":"","code":"set.seed(123) train_idx <- sample(1:nrow(admix$X), 100)  # Note: ^ shuffling is important here! Keeps test and train groups comparable. train <- list(X = admix$X[train_idx,], y = admix$y[train_idx]) test <- list(X = admix$X[-train_idx,], y = admix$y[-train_idx]) fit <- plmm(X = train$X, y = train$y, K = relatedness_mat(train$X))  # make predictions for all lambda values   pred1 <- predict(object = fit, newX = test$X, type = \"blup\", X = train$X, y = train$y)  # look at mean squared prediction error mspe <- apply(pred1, 2, function(c){crossprod(test$y - c)/length(c)}) min(mspe) #> [1] 1.930797  # compare the MSPE of our model to a null model, for reference # null model = intercept only -> y_hat is always mean(y) crossprod(mean(test$y) - test$y)/length(test$y) #>          [,1] #> [1,] 6.381748"},{"path":"/reference/predict_within_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict method to use in cross-validation (within cvf) — predict_within_cv","title":"Predict method to use in cross-validation (within cvf) — predict_within_cv","text":"Predict method use cross-validation (within cvf)","code":""},{"path":"/reference/predict_within_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict method to use in cross-validation (within cvf) — predict_within_cv","text":"","code":"predict_within_cv(   fit,   oldX,   newX,   type = c(\"lp\", \"blup\"),   fbm = FALSE,   idx = 1:length(fit$lambda),   V11 = NULL,   V21 = NULL,   ... )"},{"path":"/reference/predict_within_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict method to use in cross-validation (within cvf) — predict_within_cv","text":"fit list components returned plmm_fit. oldX standardized design matrix training data, pre-rotation. newX design matrix used computing predicted values (.e, test data). type character argument indicating type prediction returned. Options \"lp,\" \"coefficients,\" \"vars,\" \"nvars,\" \"blup.\" See details. fbm Logical: oldX FBM object? , function expects newX also FBM. two X matrices must stored way. idx Vector indices penalty parameter lambda predictions required. default, indices returned. V11 Variance-covariance matrix training data. Extracted estimated_V generated using observations. Required type == 'blup'. V21 Covariance matrix training testing data. Extracted estimated_V generated using observations. Required type == 'blup'. ... Additional optional arguments","code":""},{"path":"/reference/predict_within_cv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict method to use in cross-validation (within cvf) — predict_within_cv","text":"Define beta-hat coefficients estimated value lambda minimizes cross-validation error (CVE). options type follows: 'lp' (default): uses linear predictor (.e., product new data estimated coefficients) predict new values outcome. Note approach incorporate correlation structure data. 'blup' (acronym Best Linear Unbiased Predictor): adds 'lp' value represents estimated random effect. addition way incorporating estimated correlation structure data prediction outcome.","code":""},{"path":"/reference/print.summary.cv.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","title":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","text":"Print method summary.cv.plmm objects","code":""},{"path":"/reference/print.summary.cv.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","text":"","code":"# S3 method for summary.cv.plmm print(x, digits, ...)"},{"path":"/reference/print.summary.cv.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","text":"x object class summary.cv.plmm digits number digits use formatting output ... used","code":""},{"path":"/reference/print.summary.cv.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","text":"Nothing returned; instead, message printed console summarizing results cross-validated model fit.","code":""},{"path":"/reference/print.summary.cv.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for summary.cv.plmm objects — print.summary.cv.plmm","text":"","code":"cv_fit <- cv.plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X)) print(summary(cv_fit)) #> MCP-penalized model with n=197 and p=100 #> At minimum cross-validation error (lambda=0.4279): #> ------------------------------------------------- #>   Nonzero coefficients: 0 #>   Cross-validation error (deviance): 1.98 #>   Scale estimate (sigma): 1.408"},{"path":"/reference/print.summary.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to print the summary of a plmm model — print.summary.plmm","title":"A function to print the summary of a plmm model — print.summary.plmm","text":"function print summary plmm model","code":""},{"path":"/reference/print.summary.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to print the summary of a plmm model — print.summary.plmm","text":"","code":"# S3 method for summary.plmm print(x, ...)"},{"path":"/reference/print.summary.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to print the summary of a plmm model — print.summary.plmm","text":"x summary.plmm object ... used","code":""},{"path":"/reference/print.summary.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to print the summary of a plmm model — print.summary.plmm","text":"Nothing returned; instead, message printed console summarizing results model fit.","code":""},{"path":"/reference/print.summary.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to print the summary of a plmm model — print.summary.plmm","text":"","code":"fit <- plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X)) fit2 <- plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X), penalty = \"SCAD\") s1 <- summary(fit, idx = 97) s2 <- summary(fit, lambda = fit$lambda[97]) s3 <- summary(fit2, idx = 25) print(s1) #> MCP-penalized regression model with n=197, p=101 at lambda=0.0020 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  97  #> ------------------------------------------------- print(s2) #> MCP-penalized regression model with n=197, p=101 at lambda=0.0020 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  97  #> ------------------------------------------------- print(s3) #> SCAD-penalized regression model with n=197, p=101 at lambda=0.3050 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  13  #> -------------------------------------------------"},{"path":"/reference/process_delim.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to read in large data files as an FBM — process_delim","title":"A function to read in large data files as an FBM — process_delim","text":"function read large data files FBM","code":""},{"path":"/reference/process_delim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to read in large data files as an FBM — process_delim","text":"","code":"process_delim(   file,   data_dir,   rds_dir = data_dir,   ind.col,   non_gen = NULL,   outfile,   overwrite = FALSE,   quiet = FALSE )"},{"path":"/reference/process_delim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to read in large data files as an FBM — process_delim","text":"file file read , without filepath. file numeric values, header row! Headers taken file supplied col_names argument plmm() Example: use file = \"myfile.txt\", file = \"~/mydirectory/myfile.txt\" data_dir directory file rds_dir directory user wants create '.rds' '.bk' files Defaults data_dir ind.col Numeric vector columns read . use negative indicies. sure many columns file, use something like data.table::fread() examine first row two. non_gen Numeric vector indices columns non-genomic information. Note: plan estimating genomic relatedness among observations file, must include information order estimates correct. outfile Optional: name (character string) prefix logfile written. Defaults 'process_delim', .e. get 'process_delim.log' outfile. overwrite Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. quiet Logical: messages printed console silenced? Defaults FALSE.","code":""},{"path":"/reference/process_delim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to read in large data files as an FBM — process_delim","text":"Nothing returned function, (least) two files created location specified rds_dir: 'std_prefix.rds': bigsnpr::bigSNP object holds PLINK data along meta-data. See details explanation included meta-data 'std_prefix.bk': Created call standardize_fbm(), backingfile stores numeric data standardized design matrix std_X","code":""},{"path":"/reference/process_delim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A function to read in large data files as an FBM — process_delim","text":"","code":"# \\donttest{ temp_dir <- tempdir() process_delim(file = \"colon2.txt\",  data_dir = get_example_data(parent = TRUE),  rds_dir = temp_dir,   ind.col = 2:2002) #>  #> Logging to /tmp/Rtmpq1dXaW/process_data.log #> Preprocessing colon2 data: #> There are a total of  20 features with missing values.  #>        #> At this time, plmmr::process_delim() does not impute missing values. We  #>       are working to develop this feature.  #>        #> For now, plmmr::process_delim() will drop all columns of X with NA values. #> Column-standardizing the design matrix... #> Error: Two levels of parallelism are used. See `?assert_cores`.  # }"},{"path":"/reference/process_plink.html","id":null,"dir":"Reference","previous_headings":"","what":"Preprocess PLINK files using the bigsnpr package — process_plink","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"Preprocess PLINK files using bigsnpr package","code":""},{"path":"/reference/process_plink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"","code":"process_plink(   data_dir,   prefix,   rds_dir = data_dir,   impute = TRUE,   impute_method = \"mode\",   na_phenotype_vals = c(-9),   id_var = \"IID\",   handle_missing_phen = \"prune\",   add_phen = NULL,   pheno_id = NULL,   pheno_name = NULL,   quiet = FALSE,   gz = FALSE,   outfile,   overwrite = FALSE,   add_predictor_fam = NULL,   add_predictor_ext = NULL,   keep_bigSNP = FALSE,   ... )"},{"path":"/reference/process_plink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"data_dir path bed/bim/fam data files, without trailing \"/\" (e.g., use data_dir = '~/my_dir', data_dir = '~/my_dir/') prefix prefix (character string) bed/fam data files (e.g., prefix = 'mydata') rds_dir path directory want create new '.rds' '.bk' files. Defaults data_dir impute Logical: data imputed? Default TRUE. impute_method 'impute' = TRUE, argument specify kind imputation desired. Options : * mode (default): Imputes frequent call. See bigsnpr::snp_fastImputeSimple() details. * random: Imputes sampling according allele frequencies. * mean0: Imputes rounded mean. * mean2: Imputes mean rounded 2 decimal places. * xgboost: Imputes using algorithm based local XGBoost models. See bigsnpr::snp_fastImpute() details. Note: can take several minutes, even relatively small data set. na_phenotype_vals vector numeric values used code NA values phenotype/outcome ('affection' column bigSNP object, last column .fam file). Defaults -9 (matching PLINK conventions). id_var String specifying column PLINK .fam file unique sample identifiers. Options \"IID\" (default) \"FID\". handle_missing_phen string indicating missing phenotypes handled: * \"prune\" (default): observations missing phenotype removed * \"median\": impute missing phenotypes using median (warning: overly simplistic many cases). * \"mean\": impute missing phenotypes using mean (warning: overly simplistic many cases). Note: data coming PLINK, missing values phenotype allowed. (1) supply phenotype external file, (2) prune missing values, (3) impute missing values. add_phen Optional: data frame least two columns: ID column phenotype column pheno_id Optional: string specifying name ID column pheno. MUST specified add_phen specified. pheno_name Optional: string specifying name phenotype column pheno.  MUST specified add_phen specified. column used default y argument 'plmm()'. quiet Logical: messages printed console silenced? Defaults FALSE gz Logical: bed/bim/fam files g-zipped? Defaults FALSE. NOTE: TRUE, process_plink unzip zipped files. outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. overwrite Logical: existing .bk/.rds files exist specified directory/prefix, overwritten? Defaults FALSE. Set TRUE want change imputation method using, etc. add_predictor_fam Optional: want include \"sex\" (5th column .fam file) analysis, specify 'sex' . add_predictor_ext Optional: add additional covariates/predictors/features external file (.e., PLINK file). argument takes one two kinds arguments: - named numeric vector, names align sample IDs PLINK files. names used subset align external covariate supplied PLINK data.   keep_bigSNP Logical: intermediate steps data processing saved bigSNP object? Defaults FALSE. ... Optional: additional arguments bigsnpr::snp_fastImpute() (relevant impute_method = \"xgboost\")","code":"- a numeric matrix whose row names align with the sample IDs in the PLINK files.                        The names will be used to subset and align this external covariate with the supplied PLINK data."},{"path":"/reference/process_plink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"Nothing returned function, (least) two files created location specified rds_dir: 'std_prefix.rds': bigsnpr::bigSNP object holds PLINK data along meta-data. See details explanation included meta-data 'std_prefix.bk': Created call standardize_fbm(), backingfile stores numeric data standardized design matrix std_X Intermediate files 'prefix.rds' 'prefix.bk' also created along way; keep_bigSNP = TRUE, deleted end process_plink() procedure. Note files potentially quite large - main reason keeping files default setting. Note process_plink() need run given set PLINK files; subsequent data analysis/scripts, get_data() access '.rds' file.","code":""},{"path":"/reference/process_plink.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"'.rds' object created function following elements: std_X: file-backed design matrix, FBM object (see bigstatsr package info) fam: Data frame equivalent PLINK '.bim' file map: Data frame equivalent PLINK '.fam' file colnames: Character vector column names original data (includes constant features, .e. monomorphic SNPs) rownames: Character vector row names original data. n: Number rows (samples) original data p: Number columns (features, SNPs, markers, ...) original data ns: Numeric vector indices marking non-singular columns original data std_X_center: Numeric vector values used center non-singular columns data std_X_scale: Numeric vector values used scale non-singular columns data std_X_colnames: Character vector column names standardized data std_X_rownames: Character vector row names standardized data. complete_phen: Numeric vector indices marking samples non-missing phenotype. Ony applicable handle_missing_phen = 'prune' id_var: String specifying ID column '.fam' file unique sample ID: 'FID' (1st column) 'IID' (2nd column)","code":""},{"path":"/reference/process_plink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preprocess PLINK files using the bigsnpr package — process_plink","text":"","code":"# \\donttest{ my_dir <- tempdir() process_plink(data_dir = get_example_data(parent = TRUE),   rds_dir = my_dir,   prefix = \"penncath_lite\",   gz = TRUE,   outfile = \"process_penncath\",   overwrite = TRUE,   impute_method = \"mode\") #>  #> Logging to process_penncath.log #> Preprocessing penncath_lite data: #> Overwriting existing files:  penncath_lite .bk/.rds #>  #> Creating  penncath_lite .rds #>  #> Unzipping .gz files - this could take a second #> There are  1401  observations and  4367  genomic features in the specified data files, representing chromosomes  1  -  22 #> There are a total of  3514 SNPs with missing values #> Of these,  13  are missing in at least 50% of the samples #> Will prune out  468  samples/observations with missing phenotype data. #> Imputing the missing (genotype) values using  mode  method #> Error: Two levels of parallelism are used. See `?assert_cores`. # }"},{"path":"/reference/read_data_files.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to read in a large file as a numeric file-backed matrix (FBM) Note: this function is a wrapper for bigstatsr::big_read() — read_data_files","title":"A function to read in a large file as a numeric file-backed matrix (FBM) Note: this function is a wrapper for bigstatsr::big_read() — read_data_files","text":"function read large file numeric file-backed matrix (FBM) Note: function wrapper bigstatsr::big_read()","code":""},{"path":"/reference/read_data_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to read in a large file as a numeric file-backed matrix (FBM) Note: this function is a wrapper for bigstatsr::big_read() — read_data_files","text":"","code":"read_data_files(file, data_dir, rds_dir, ind.col, outfile, overwrite, quiet)"},{"path":"/reference/read_data_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to read in a large file as a numeric file-backed matrix (FBM) Note: this function is a wrapper for bigstatsr::big_read() — read_data_files","text":"file name file read, including directory. Directory specified data_dir data_dir path directory 'file' rds_dir path directory want create new '.rds' '.bk' files. Defaults data_dir ind.col indices (positive integers) sorted ascending order. Passed bigstatsr::big_read() outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. overwrite Logical: existing .bk/.rds files exist specified directory/prefix, overwritten? Defaults FALSE. Set TRUE want change imputation method using, etc. quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/read_data_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to read in a large file as a numeric file-backed matrix (FBM) Note: this function is a wrapper for bigstatsr::big_read() — read_data_files","text":"'.rds' '.bk' files created data_dir, obj (bigSNP object) returned. See bigsnpr documentation info bigSNP class.","code":""},{"path":"/reference/read_plink_files.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to read in PLINK files using bigsnpr methods — read_plink_files","title":"A function to read in PLINK files using bigsnpr methods — read_plink_files","text":"function read PLINK files using bigsnpr methods","code":""},{"path":"/reference/read_plink_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to read in PLINK files using bigsnpr methods — read_plink_files","text":"","code":"read_plink_files(data_dir, prefix, rds_dir, gz, outfile, overwrite, quiet)"},{"path":"/reference/read_plink_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A function to read in PLINK files using bigsnpr methods — read_plink_files","text":"data_dir path bed/bim/fam data files, without trailing \"/\" (e.g., use data_dir = '~/my_dir', data_dir = '~/my_dir/') prefix prefix (character string) bed/fam data files (e.g., prefix = 'mydata') rds_dir path directory want create new '.rds' '.bk' files. Defaults data_dir gz Logical: bed/bim/fam files g-zipped? Defaults FALSE. NOTE: TRUE, process_plink unzip zipped files. outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. overwrite Logical: existing .bk/.rds files exist specified directory/prefix, overwritten? Defaults FALSE. Set TRUE want change imputation method using, etc. quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/read_plink_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to read in PLINK files using bigsnpr methods — read_plink_files","text":"'.rds' '.bk' files created data_dir, obj (bigSNP object) returned. See bigsnpr documentation info bigSNP class.","code":""},{"path":"/reference/relatedness_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a relatedness matrix — relatedness_mat","title":"Calculate a relatedness matrix — relatedness_mat","text":"function allows generate n n genetic relatedness matrix. numeric matrix supplied, RRM (Hayes, 2009) used computed XX'/p, X standardized.","code":""},{"path":"/reference/relatedness_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a relatedness matrix — relatedness_mat","text":"","code":"relatedness_mat(X, std = TRUE, fbm = FALSE, ns = NULL, ...)"},{"path":"/reference/relatedness_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a relatedness matrix — relatedness_mat","text":"X n x p numeric matrix genotypes (fully-imputed data). Note: matrix include non-genetic features. std Logical: X standardized? set FALSE, know exactly appropriate... standardization best practice, impact results. fbm Logical: X stored FBM? Defaults FALSE ns Optional vector values indicating indices nonsingular features ... optional arguments bigstatsr::bigapply() (like ncores = ...)","code":""},{"path":"/reference/relatedness_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a relatedness matrix — relatedness_mat","text":"n x n numeric matrix capturing genomic relatedness samples represented X. notation, call matrix K 'kinship'; matrix also sometimes called GRM 'genomic relatedness matrix'","code":""},{"path":"/reference/relatedness_mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate a relatedness matrix — relatedness_mat","text":"","code":"RRM <- relatedness_mat(X = admix$X)"},{"path":"/reference/residuals.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract residuals from a PLMM fit — residuals.plmm","title":"Extract residuals from a PLMM fit — residuals.plmm","text":"Currently, deviance residuals supported.","code":""},{"path":"/reference/residuals.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract residuals from a PLMM fit — residuals.plmm","text":"","code":"# S3 method for plmm residuals(   object,   lambda,   which = 1:length(object$lambda),   drop = TRUE,   unrotate = FALSE,   ... )"},{"path":"/reference/residuals.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract residuals from a PLMM fit — residuals.plmm","text":"object Object class plmm. lambda Optional numeric value(s) regularization parameter residuals requested (numeric vector). values lambda sequence fitted models, linear interpolation used. Index penalty parameter residuals requested (default = indices). lambda specified, take precedence . drop default, single value lambda supplied, vector residuals returned (logical; default=TRUE). Set drop=FALSE wish function always return matrix (see drop()). unrotate Logical: residuals 'unrotated', .e. transformed back original scale? ... used.","code":""},{"path":"/reference/residuals.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract residuals from a PLMM fit — residuals.plmm","text":"numeric matrix residuals transformed scale, rows correspond observations (e.g., samples) columns correspond values lambda model fit.","code":""},{"path":"/reference/residuals.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract residuals from a PLMM fit — residuals.plmm","text":"","code":"# \\donttest{ fit <- plmm(admix$X, admix$y) residuals.plmm(fit)[1:5, 1:5] #> Error in residuals.plmm(fit): could not find function \"residuals.plmm\" head(residuals.plmm(fit, which = 50)) #> Error in residuals.plmm(fit, which = 50): could not find function \"residuals.plmm\" # }"},{"path":"/reference/rotate_filebacked.html","id":null,"dir":"Reference","previous_headings":"","what":"A function to rotate filebacked data — rotate_filebacked","title":"A function to rotate filebacked data — rotate_filebacked","text":"function rotate filebacked data","code":""},{"path":"/reference/rotate_filebacked.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A function to rotate filebacked data — rotate_filebacked","text":"","code":"rotate_filebacked(prep, ...)"},{"path":"/reference/rotate_filebacked.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A function to rotate filebacked data — rotate_filebacked","text":"list 4 items: rot_X\" X rotated scale, without re-standardizing (FBM) roty_y: y rotated scale (numeric vector) stdrot_X: X rotated scale, re-standardized (FBM) stdrot_X_scale: numeric vector values used standardize rot_X","code":""},{"path":"/reference/scale_varp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate scale by the population standard deviation, without centering — scale_varp","title":"Calculate scale by the population standard deviation, without centering — scale_varp","text":"function allows scale vectors matrix population standard deviation without centering; assume sample population.","code":""},{"path":"/reference/scale_varp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate scale by the population standard deviation, without centering — scale_varp","text":"","code":"scale_varp(X)"},{"path":"/reference/scale_varp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate scale by the population standard deviation, without centering — scale_varp","text":"X numeric matrix","code":""},{"path":"/reference/setup_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sequence of lambda values — setup_lambda","title":"Compute sequence of lambda values — setup_lambda","text":"function allows compute sequence lambda values plmm models.","code":""},{"path":"/reference/setup_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sequence of lambda values — setup_lambda","text":"","code":"setup_lambda(   X,   y,   alpha,   lambda.min,   nlambda,   penalty.factor,   intercept = TRUE )"},{"path":"/reference/setup_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sequence of lambda values — setup_lambda","text":"X Rotated standardized design matrix includes intercept column present. May include clinical covariates non-SNP data. can either 'matrix' 'FBM' object. y Continuous outcome vector. alpha Tuning parameter Mnet estimator controls relative contributions MCP/SCAD penalty ridge, L2 penalty. alpha=1 equivalent MCP/SCAD penalty, alpha=0 equivalent ridge regression. However, alpha=0 supported; alpha may arbitrarily small, exactly 0. lambda.min smallest value lambda, fraction lambda.max. Default .001 number observations larger number covariates .05 otherwise. value lambda.min = 0 supported. nlambda desired number lambda values sequence generated. penalty.factor multiplicative factor penalty applied coefficient. supplied, penalty.factor must numeric vector length equal number columns X. purpose penalty.factor apply differential penalization coefficients thought likely others model. particular, penalty.factor can 0, case coefficient always model without shrinkage. intercept Logical: X contain intercept column? Defaults TRUE.","code":""},{"path":"/reference/standardize_bigsnp.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to standardize a bigSNP — standardize_bigsnp","title":"A helper function to standardize a bigSNP — standardize_bigsnp","text":"helper function standardize bigSNP","code":""},{"path":"/reference/standardize_bigsnp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to standardize a bigSNP — standardize_bigsnp","text":"","code":"standardize_bigsnp(   obj,   prefix,   rds_dir,   non_gen,   complete_phen,   id_var,   outfile,   quiet )"},{"path":"/reference/standardize_bigsnp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to standardize a bigSNP — standardize_bigsnp","text":"obj bigSNP object prefix prefix (character string) bed/fam data files (e.g., prefix = 'mydata') rds_dir path directory want create new '.rds' '.bk' files. Defaults data_dir non_gen integer vector ranges 1 number added predictors. Example: 2 predictors added, non_gen = 1:2. Note: typically passed result add_predictors() complete_phen Numeric vector indicies marking rows original data non-missing entry 6th column .fam file id_var String specifying column PLINK .fam file unique sample identifiers. Options \"IID\" (default) \"FID\". outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/standardize_bigsnp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to standardize a bigSNP — standardize_bigsnp","text":"list new component obj called 'std_X' - FBM column-standardized data. List also includes several indices/meta-data standardized matrix","code":""},{"path":"/reference/standardize_fbm.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to standardize an FBM — standardize_fbm","title":"A helper function to standardize an FBM — standardize_fbm","text":"helper function standardize FBM","code":""},{"path":"/reference/standardize_fbm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to standardize an FBM — standardize_fbm","text":"","code":"standardize_fbm(subset_X, prefix, rds_dir, ns, non_gen, outfile, quiet)"},{"path":"/reference/standardize_fbm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to standardize an FBM — standardize_fbm","text":"subset_X FBM prefix data file name without extension rds_dir directory user wants create '.rds' '.bk' files ns Integer vector indices non-singular columns subset_X non_gen Integer vector indices non-genomic covariates outfile Optional: name (character string) prefix logfile written. quiet Logical: messages printed console silenced? Defaults FALSE.","code":""},{"path":"/reference/standardize_fbm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to standardize an FBM — standardize_fbm","text":"list includes: 'std_X' - standardized FBM 'center' - vector  values used center columns 'scale' - vector values used scale columns","code":""},{"path":"/reference/standardize_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to standardize matrices — standardize_matrix","title":"A helper function to standardize matrices — standardize_matrix","text":"helper function standardize matrices","code":""},{"path":"/reference/standardize_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to standardize matrices — standardize_matrix","text":"","code":"standardize_matrix(X, penalty.factor)"},{"path":"/reference/standardize_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to standardize matrices — standardize_matrix","text":"X matrix penalty.factor vector 0s 1s, passed plmm()","code":""},{"path":"/reference/standardize_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to standardize matrices — standardize_matrix","text":"list standardized matrix details","code":""},{"path":"/reference/subset_bigsnp.html","id":null,"dir":"Reference","previous_headings":"","what":"A helper function to subset bigSNP objects — subset_bigsnp","title":"A helper function to subset bigSNP objects — subset_bigsnp","text":"helper function subset bigSNP objects","code":""},{"path":"/reference/subset_bigsnp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A helper function to subset bigSNP objects — subset_bigsnp","text":"","code":"subset_bigsnp(   obj,   counts,   handle_missing_phen,   complete_phen,   non_gen,   data_dir,   prefix,   outfile,   quiet )"},{"path":"/reference/subset_bigsnp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A helper function to subset bigSNP objects — subset_bigsnp","text":"obj bigSNP object counts dataframe returned bigstatsr::big_counts() handle_missing_phen string indicating missing phenotypes handled: \"prune\" (default): observations missing phenotype removed \"asis\": leaves missing phenotypes NA (fine outcome supplied later separate file) \"median\": impute missing phenotypes using median (warning: overly simplistic many cases). \"mean\": impute missing phenotypes using mean (warning: overly simplistic many cases). complete_phen Numeric vector indicies marking rows original data non-missing entry 6th column .fam file non_gen integer vector ranges 1 number added predictors. Example: 2 predictors added, non_gen = 1:2. Note: typically passed result add_predictors() data_dir path bed/bim/fam data files, without trailing \"/\" (e.g., use data_dir = '~/my_dir', data_dir = '~/my_dir/') prefix prefix (character string) bed/fam data files (e.g., prefix = 'mydata') outfile Optional: name (character string) prefix logfile written. Defaults 'process_plink', .e. get 'process_plink.log' outfile. quiet Logical: messages printed console? Defaults TRUE","code":""},{"path":"/reference/subset_bigsnp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A helper function to subset bigSNP objects — subset_bigsnp","text":"bigSNP object includes new component, 'subset_X', representing design matrix wherein: rows subset according user's specification handle_missing_phen columns subset constant features remain -- important standardization downstream new 'obj' also includes integer vector 'ns' marks columns original matrix 'non-singular' (.e. constant features). 'ns' index plays important role plmm_format() untransform() (helper functions model fitting)","code":""},{"path":"/reference/summary.cv.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"A summary function for cv.plmm objects — summary.cv.plmm","title":"A summary function for cv.plmm objects — summary.cv.plmm","text":"summary function cv.plmm objects","code":""},{"path":"/reference/summary.cv.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A summary function for cv.plmm objects — summary.cv.plmm","text":"","code":"# S3 method for cv.plmm summary(object, lambda = \"min\", ...)"},{"path":"/reference/summary.cv.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A summary function for cv.plmm objects — summary.cv.plmm","text":"object cv.plmm object lambda regularization parameter value inference reported. Can choose numeric value, 'min', '1se'. Defaults 'min.' ... used","code":""},{"path":"/reference/summary.cv.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A summary function for cv.plmm objects — summary.cv.plmm","text":"return value object S3 class summary.cv.plmm. class print method contains following list elements: lambda.min: lambda value minimum cross validation error lambda.1se: maximum lambda value within 1 standard error minimum cross validation error penalty: penalty applied fitted model nvars: number non-zero coefficients selected lambda value cve: cross validation error folds min: minimum cross validation error fit: plmm fit used cross validation returnBiasDetails = TRUE, two items returned: bias: mean bias cross validation loss: loss value lambda","code":""},{"path":"/reference/summary.cv.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A summary function for cv.plmm objects — summary.cv.plmm","text":"","code":"cv_fit <- cv.plmm(X = admix$X, y = admix$y,  K = relatedness_mat(admix$X), penalty = 'lasso', returnBiasDetails = TRUE) summary(cv_fit) #> lasso-penalized model with n=197 and p=100 #> At minimum cross-validation error (lambda=0.2625): #> ------------------------------------------------- #>   Nonzero coefficients: 5 #>   Cross-validation error (deviance): 1.95 #>   Scale estimate (sigma): 1.398"},{"path":"/reference/summary.plmm.html","id":null,"dir":"Reference","previous_headings":"","what":"A summary method for the plmm objects — summary.plmm","title":"A summary method for the plmm objects — summary.plmm","text":"summary method plmm objects","code":""},{"path":"/reference/summary.plmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A summary method for the plmm objects — summary.plmm","text":"","code":"# S3 method for plmm summary(object, lambda, idx, eps = 1e-05, ...)"},{"path":"/reference/summary.plmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A summary method for the plmm objects — summary.plmm","text":"object object class plmm lambda regularization parameter value inference reported. idx Alternatively, lambda may specified index; idx=10 means: report inference 10th value lambda along regularization path. lambda idx specified, lambda takes precedence. eps lambda given, eps tolerance difference given lambda value lambda value object. Defaults 0.0001 (1e-5) ... used","code":""},{"path":"/reference/summary.plmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"A summary method for the plmm objects — summary.plmm","text":"return value object S3 class summary.plmm. class print method contains following list elements: penalty: penalty used plmm (e.g. SCAD, MCP, lasso) n: Number instances/observations p: Number regression coefficients (including intercept) converged: Logical indicator whether model converged lambda: lambda value inference reported lambda_char: formatted character string indicating lambda value nvars: number nonzero coefficients (, including intercept) value lambda nonzero: column names indicating nonzero coefficients model specified value lambda constant_features: character vector names columns design matrix whose values constant whole sample (e.g., monomorphic SNPs genetics context)","code":""},{"path":"/reference/summary.plmm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A summary method for the plmm objects — summary.plmm","text":"","code":"fit <- cv.plmm(X = admix$X, y = admix$y, K = relatedness_mat(admix$X)) summary(fit$fit, idx = 97) #> MCP-penalized regression model with n=197, p=101 at lambda=0.00053 #> ------------------------------------------------- #> The model converged  #> ------------------------------------------------- #> # of non-zero coefficients:  98  #> ------------------------------------------------- summary(fit, lambda = fit$lambda.min) #> MCP-penalized model with n=197 and p=100 #> At minimum cross-validation error (lambda=0.4279): #> ------------------------------------------------- #>   Nonzero coefficients: 0 #>   Cross-validation error (deviance): 2.01 #>   Scale estimate (sigma): 1.419"},{"path":"/reference/untransform.html","id":null,"dir":"Reference","previous_headings":"","what":"Untransform coefficient values back to the original scale — untransform","title":"Untransform coefficient values back to the original scale — untransform","text":"function unwinds initial standardization data obtain coefficient values original scale. called plmm_format().","code":""},{"path":"/reference/untransform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Untransform coefficient values back to the original scale — untransform","text":"","code":"untransform(untransformed_b1, p, std_X_details, fbm_flag, non_genomic)"},{"path":"/reference/untransform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Untransform coefficient values back to the original scale — untransform","text":"untransformed_b1 estimated coefficients standardized scale p number columns original design matrix std_X_details list 3 elements describing standardized design matrix rotation; elements 'scale', 'center', 'ns' fbm_flag Logical: corresponding design matrix filebacked? non_genomic Optional vector specifying columns design matrix represent features genomic, features excluded empirical estimation genomic relatedness. cases X filepath object created process_plink(), handled automatically via arguments process_plink(). cases, 'non_genomic' defaults NULL (meaning plmm() assume columns X represent genomic features).","code":""},{"path":"/reference/varp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the population variance — varp","title":"Calculate the population variance — varp","text":"function allows calculate population variance; assume sample population.","code":""},{"path":"/reference/varp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the population variance — varp","text":"","code":"varp(x)"},{"path":"/reference/varp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the population variance — varp","text":"x numeric vector","code":""},{"path":"/news/index.html","id":"plmmr-300","dir":"Changelog","previous_headings":"","what":"plmmr 3.0.0","title":"plmmr 3.0.0","text":"Notable changes Soon--initial CRAN submission! first version plmmr incorporates support file-backed data, allowing user analyze data files large fit memory.","code":""},{"path":"/news/index.html","id":"plmmr-221","dir":"Changelog","previous_headings":"","what":"plmmr 2.2.1","title":"plmmr 2.2.1","text":"Notable changes Changed package name plmmr - note plmm(), cv.plmm(), functions starting plmm_ changed names.","code":""}]
