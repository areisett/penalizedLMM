<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Notes on notation • plmmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Notes on notation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plmmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/process_plink_files.html">If your data is from PLINK...</a></li>
    <li><a class="dropdown-item" href="../articles/notation.html">Notes on notation</a></li>
    <li><a class="dropdown-item" href="../articles/filebacking.html">File-backed data (how to work with big files)</a></li>
    <li><a class="dropdown-item" href="../articles/deconfounding.html">In progress: PLMMs &amp; deconfounding</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/plmmr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Notes on notation</h1>
            
      

      <div class="d-none name"><code>notation.Rmd</code></div>
    </div>

    
    
<p>The purpose of this short vignette is to document the notation
conventions for the math and programming related to PLMM. We begin with
the math, and then translate our math notation into naming objects in
our source code.</p>
<p>Throughout this document, the reader will notice some notation
conventions:</p>
<ul>
<li>Matrices are denoted with <strong>boldface</strong>, UPPERCASE
letters</li>
<li>Vectors are denoted with <strong>boldface</strong> lowercase
letters</li>
<li>Scalar values and indices are denoted with lowercase letters</li>
<li>the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow></mrow><mo accent="true">̇</mo></mover><annotation encoding="application/x-tex">\dot{}</annotation></semantics></math>
modifier indicates (column) standardization</li>
<li>the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow></mrow><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{}</annotation></semantics></math>
modifier indicates rotation</li>
</ul>
<div class="section level2">
<h2 id="math-notation">Math notation<a class="anchor" aria-label="anchor" href="#math-notation"></a>
</h2>
<p>Here are the concepts we need to denote, in order of their usage in
our derivations. I have blocked these into sections corresponding to the
steps of the model fitting process.</p>
<div class="section level3">
<h3 id="statistical-model-the-overall-framework">Statistical model (the overall framework)<a class="anchor" aria-label="anchor" href="#statistical-model-the-overall-framework"></a>
</h3>
<p>The overall model can be written as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐲</mi><mo>=</mo><mi>𝐗</mi><mi>𝛃</mi><mo>+</mo><mi>𝐙</mi><mi>𝛄</mi><mo>+</mo><mi>𝛜</mi></mrow><annotation encoding="application/x-tex">
\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \mathbf{Z}\boldsymbol{\gamma} + \boldsymbol{\epsilon}
</annotation></semantics></math></p>
<p>or equivalently as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐲</mi><mo>=</mo><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><mo>+</mo><mi>𝐮</mi><mo>+</mo><mi>𝛜</mi></mrow><annotation encoding="application/x-tex">
\mathbf{y} = \dot{\mathbf{X}}\dot{\boldsymbol{\beta}} + \mathbf{u} + \boldsymbol{\epsilon}
</annotation></semantics></math> where:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐲</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math>
are the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
design matrix of our data and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \times 1</annotation></semantics></math>
vector of outcomes, respectively. Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the number of <em>observations</em> (e.g., number of patients, number
of samples, etc.) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is the number of <em>features</em> (e.g., number of SNPs, number of
variables, number of covariates, etc.).</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><annotation encoding="application/x-tex">\dot{\mathbf{X}}</annotation></semantics></math>
is the column-standardized
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>,
in which each of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
columns has mean 0 and standard deviation 1. Note:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><annotation encoding="application/x-tex">\dot{\mathbf{X}}</annotation></semantics></math>
excludes any singular features (columns of constants) in the original
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><annotation encoding="application/x-tex">\dot{\boldsymbol{\beta}}</annotation></semantics></math>
represents the coefficients on the standardized scale.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐙</mi><annotation encoding="application/x-tex">\mathbf{Z}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">n \times b</annotation></semantics></math>
matrix of indicators corresponding to a grouping structure, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
is the vector of values describing how each grouping is associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐲</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math>.
In real data, these values typically unknown.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛜</mi><annotation encoding="application/x-tex">\boldsymbol{\epsilon}</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \times 1</annotation></semantics></math>
vector of noise.</p></li>
</ul>
<p>We define the realized (or empirical) relatedness matrix as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐊</mi><mo>≡</mo><mfrac><mn>1</mn><mi>p</mi></mfrac><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><msup><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{K} \equiv \frac{1}{p}\dot{\mathbf{X}}\dot{\mathbf{X}}^\top</annotation></semantics></math></p>
<p>This model assumes:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛜</mi><mo>⊥</mo><mi>𝐮</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\epsilon} \perp \mathbf{u}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛜</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mi>𝐈</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\epsilon} \sim N(0, \sigma^2_{\epsilon}\mathbf{I})</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐮</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>s</mi><mn>2</mn></msubsup><mi>𝐊</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{u} \sim N(0, \sigma^2_{s}\mathbf{K})</annotation></semantics></math></li>
</ul>
<p>Under these assumptions, we may write
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐲</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><mo>,</mo><mi>𝚺</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{y} \sim N(\dot{\mathbf{X}}\dot{\boldsymbol{\beta}}, \boldsymbol{\Sigma})</annotation></semantics></math></p>
<p><strong>Indices</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i \in 1,..., n</annotation></semantics></math>
indexes observations</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>∈</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">j \in 1,..., p</annotation></semantics></math>
indexes features</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>∈</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">h \in 1,..., b</annotation></semantics></math>
indexes the batches (e.g., different family groups, different data
collection sites, etc.)</li>
</ul>
</div>
<div class="section level3">
<h3 id="decomposition-and-rotation-prep-and-first-part-of-fit">Decomposition and rotation (prep and first part of fit)<a class="anchor" aria-label="anchor" href="#decomposition-and-rotation-prep-and-first-part-of-fit"></a>
</h3>
<ul>
<li><p>Beginning with an eigendecomposition, we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐬</mi><annotation encoding="application/x-tex">\mathbf{s}</annotation></semantics></math>
are the eigenvectors and eigenvalues of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐊</mi><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math>,
as one would obtain from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">eigen</mtext><mo stretchy="false" form="prefix">(</mo><mrow><mi>𝐊</mi><mo stretchy="false" form="postfix" mathvariant="bold">)</mo></mrow><mo>≡</mo><mi>𝐔</mi><mi>𝐒</mi><msup><mi>𝐔</mi><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\text{eigen}(\mathbf{K)} \equiv \mathbf{U}\mathbf{S}\mathbf{U}^\top</annotation></semantics></math>.
The elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐬</mi><annotation encoding="application/x-tex">\mathbf{s}</annotation></semantics></math>
are the diagonal values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐒</mi><annotation encoding="application/x-tex">\mathbf{S}</annotation></semantics></math>.
Note, random effect
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐮</mi><annotation encoding="application/x-tex">\mathbf{u}</annotation></semantics></math>
is distinct from the columns of matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
represents the number of nonzero eigenvalues represented in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐝</mi><annotation encoding="application/x-tex">\mathbf{d}</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≤</mo><mtext mathvariant="normal">min</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">k \leq \text{min}(n,p)</annotation></semantics></math>.</p></li>
<li><p>Again,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐊</mi><mo>≡</mo><mfrac><mn>1</mn><mi>p</mi></mfrac><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><msup><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{K} \equiv \frac{1}{p}\dot{\mathbf{X}}\dot{\mathbf{X}}^{\top}</annotation></semantics></math>
is often referred to in the literature as the realized relatedness
matrix (RRM) or genomic relatedness matrix (GRM).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐊</mi><annotation encoding="application/x-tex">\mathbf{K}</annotation></semantics></math>
has dimension
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msubsup><mi>σ</mi><mi>s</mi><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mi>e</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mi>s</mi><mn>2</mn></msubsup></mrow></mfrac><annotation encoding="application/x-tex">\frac{\sigma^2_s}{\sigma^2_e + \sigma^2_s}</annotation></semantics></math>.
We estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>η</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\eta}</annotation></semantics></math>
from a null model (more details to come).</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝚺</mi><annotation encoding="application/x-tex">\mathbf{\Sigma}</annotation></semantics></math>
is the variance of the outcome, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝕍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐲</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>η</mi><mi>𝐊</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐈</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{V}({\mathbf{y}}) = \eta \mathbf{K} + (1 - \eta)\mathbf{I}_n</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐰</mi><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math>
is the vector of weights defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mi>𝐬</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">(\eta\mathbf{\mathbf{s}} + (1-\eta))^{-1/2}</annotation></semantics></math>.
The values in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐰</mi><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math>
are the nonzero values of the diagonal matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐖</mi><mo>≡</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mi>𝐒</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>𝐈</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{W} \equiv (\eta\mathbf{S} + (1 - \eta)\mathbf{I})^{-1/2}</annotation></semantics></math>.</p></li>
<li><p>The matrix to be used in rotating (or <em>preconditioning</em>)
the data is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>𝚺</mi><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo>≡</mo><mi>𝐖</mi><msup><mi>𝐔</mi><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{\Sigma}^{-1/2} \equiv \mathbf{W}\mathbf{U}^\top</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mo accent="true">̃</mo></mover><mo>≡</mo><mi>𝐖</mi><msup><mi>𝐔</mi><mi>⊤</mi></msup><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\dot{\mathbf{X}}} \equiv \mathbf{W}\mathbf{U}^\top\dot{\mathbf{X}}</annotation></semantics></math>
is the rotated data, or the data on the transformed scale.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐲</mi><mo accent="true">̃</mo></mover><mo>≡</mo><msup><mi>𝚺</mi><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mi>𝐲</mi></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{y}} \equiv \mathbf{\Sigma}^{-1/2}\mathbf{y}</annotation></semantics></math>
is the outcome on the rotated scale.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo accent="true">̈</mo></mover><annotation encoding="application/x-tex">\ddot{\tilde{\mathbf{X}}}</annotation></semantics></math>
is the <strong>standardized</strong> rotated data. Note: This
standardization involves scaling, but not centering. This post-rotation
standardization impacts the estimated coefficients as well; we define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̈</mo></mover><annotation encoding="application/x-tex">{\ddot{\boldsymbol{\beta}}}</annotation></semantics></math>
as the estimated coefficients on this scale.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="model-fitting-with-penalization">Model fitting with penalization<a class="anchor" aria-label="anchor" href="#model-fitting-with-penalization"></a>
</h3>
<p>We fit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐲</mi><mo accent="true">̃</mo></mover><mo>∼</mo><mover><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo accent="true">̈</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\mathbf{y}} \sim \ddot{\tilde{\mathbf{X}}}</annotation></semantics></math>
using a penalized linear mixed model, and obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝛃</mi><mo accent="true">̈</mo></mover><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\ddot{\boldsymbol{\beta}}}</annotation></semantics></math>
as our estimated coefficients. The penalty parameter values (e.g.,
values of the lasso tuning parameter) are indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>l</mi></msub><mo>∈</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">\lambda_l \in 1,..., t</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="rescaling-results-format">Rescaling results (format)<a class="anchor" aria-label="anchor" href="#rescaling-results-format"></a>
</h3>
<p>To obtain the estimated coefficients on the original scale, the
values estimated by the model must be unscaled (or ‘untransformed’)
twice: once to adjust for the post-rotation standardization, and again
to adjust for the pre-rotation standardization. This process could be
written
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mover><mi>𝛃</mi><mo accent="true">̈</mo></mover><mo accent="true">̂</mo></mover><mo>→</mo><mover><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><mo accent="true">̂</mo></mover><mo>→</mo><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\ddot{\boldsymbol{\beta}}} \rightarrow \hat{\dot{\boldsymbol{\beta}}} \rightarrow \hat{\boldsymbol{\beta}}</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="object-names-in-source-code">Object names in source code<a class="anchor" aria-label="anchor" href="#object-names-in-source-code"></a>
</h2>
<p>In the code, we denote the objects above in this way:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐲</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math>
are <code>X</code> and <code>y</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><annotation encoding="application/x-tex">\dot{\mathbf{X}}</annotation></semantics></math>
is <code>std_X</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\dot{\mathbf{X}}}</annotation></semantics></math>
is <code>rot_X</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo accent="true">̈</mo></mover><annotation encoding="application/x-tex">\ddot{\tilde{\mathbf{X}}}</annotation></semantics></math>
is <code>stdrot_X</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}</annotation></semantics></math>
is named <code>og_scale_beta</code> in helper functions (for clarity)
and returned in <code>plmm</code> objects as <code>beta_vals</code>.
<code>beta_vals</code> and <code>og_scale_beta</code> are equivalent;
both represent the estimated coefficients on the original
scale.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\dot{\boldsymbol{\beta}}}</annotation></semantics></math>
is <code>std_scale_beta</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mover><mi>𝛃</mi><mo accent="true">̈</mo></mover><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\ddot{\boldsymbol{\beta}}}</annotation></semantics></math>
is <code>stdrot_scale_beta</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝐗</mi><mo accent="true">̇</mo></mover><mover><mover><mi>𝛃</mi><mo accent="true">̇</mo></mover><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\dot{\mathbf{X}}\hat{\dot{\boldsymbol{\beta}}}</annotation></semantics></math>
is <code>Xb</code></p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mover><mi>𝐗</mi><mo accent="true">̃</mo></mover><mo accent="true">̈</mo></mover><mover><mover><mi>𝛃</mi><mo accent="true">̈</mo></mover><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\ddot{\tilde{\mathbf{X}}} \hat{\ddot{\boldsymbol{\beta}}}</annotation></semantics></math>
is <code>linear_predictors</code>. Note: in words, this means the
<code>linear_predictors</code> in the code are on the scale of the
rotated and re-standardized data!</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>𝚺</mi><mo accent="true">̂</mo></mover><mo>≡</mo><mover><mi>η</mi><mo accent="true">̂</mo></mover><mi>𝐊</mi><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mover><mi>η</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>𝐈</mi></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\Sigma}} \equiv \hat{\eta}\mathbf{K} + (1 - \hat{\eta})\mathbf{I}</annotation></semantics></math>
is <code>estimated_Sigma</code>. Similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>𝚺</mi><mo accent="true">̂</mo></mover><mn>11</mn></msub><annotation encoding="application/x-tex">\hat{\boldsymbol{\Sigma}}_{11}</annotation></semantics></math>
is <code>Sigma_11</code>, etc.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tabitha K. Peter, Anna C. Reisetter, Patrick J. Breheny, Yujing Lu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
